<div class="container mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone"
  (mousedown)="onMouseDownAll()">
  <div class="content-file-magistor">
    <div class="content-labels">
      <base-card class="mdl-cell mdl-cell--9-col-desktop mdl-cell--9-col-tablet mdl-cell--4-col-phone">
        <base-card-body class="content-first-card-magistor">
          <div class="content-label">
            <label class="details-label">Statut</label>
            <span *ngIf="file" class="details-label-color color--{{getColor(file?.status)}}">{{file?.status}}</span>
            <!-- <span class="label label--mini color--{{getColor(row.status)}} ">{{ file?.status }}</span> -->

          </div>
          <div class="content-label">
            <label class="details-label">Date</label>
            <label class="details-label">{{file?.createdAt| date:"dd/MM/yyyy"}}</label>
          </div>
          <div class="content-label">
            <label class="details-label">Type</label>
            <label class="details-label">{{file?.logisticFileType.substr(0,3)}}</label>
          </div>
          <div class="content-label">
            <label class="details-label">Nom du fichier</label>
            <label class="details-label">{{name_file?.substr(3)}}</label>
          </div>
          <div class="content-label">
            <label class="details-label">Nom du client</label>
            <label class="details-label">{{file?.clientName}}</label>
          </div>
          <div class="content-label">
            <label class="details-label">Nombre d'anomalies</label>
            <label class="label-wrong">{{file?.number_annomalies}} </label>
          </div>
        </base-card-body>
      </base-card>
      <div *ngIf="file" style='text-align: center; display: block;'
        class="mdl-cell mdl-cell--4-col-desktop mdl-cell--4-col-tablet mdl-cell--3-col-phone">
        <!-- <div style="padding: 7px;" class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
          <div style="padding: 0px;" class="mdl-textfield label-search">
            <input style="color: white;" class="mdl-textfield__input" type="text" id="search1"
              (input)="setFilteredItemsValid()" [(ngModel)]="searchItems" placeholder="Rechercher" autocomplete="off" />
            <label class="mdl-textfield__label" for="search1"></label>
          </div>
        </div> -->
        <button [disabled]="file?.status=='Terminé'" (click)='saveModificationsOnFile();$event.stopPropagation();'
          style="margin: 3px; "
          class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">

          <i class="material-icons ">save</i>
          Enregistrer
        </button>

        <!----[disabled]="file?.number_annomalies>=1 || file?.status !=='Terminé'" !-->
        <div>
          <button (click)='openConfirmDialog("valider");$event.stopPropagation();' style="margin: 1px;"
            [disabled]="validateClicked==true || terminated || file?.ButtonValidateActivated==false"
            class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Valider
          </button>

          <button (click)='invalidateFile()' style="margin: 1px;"
            [disabled]="correctClicked==true || terminated || file?.ButtonInvalidateActivated==false"
            class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Dévalider
          </button>

          <!-- <button (click)='openConfirmDialog("corriger");$event.stopPropagation();' style="margin: 1px;"
              [disabled]="correctClicked==true ||terminated || file?.ButtonCorrecteActiveted==false"
              class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
            </button> -->
        </div>
        <!-- <button (click)='resetFiltre("metadata");$event.stopPropagation();' style="margin-left: 5px;"
            class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
            les filtres
          </button> -->
      </div>
    </div>
    <!-- <app-loader [width]="'100%'" [position]="'sticky'" [height]="'450px'" [bg]="'transparant'"
      [show]="!terminated && oneBloc && !(fileMagistor && fileMagistor2)"></app-loader>
    <app-loader [width]="'100%'" [position]="'sticky'" [height]="'450px'" [bg]="'transparant'"
      [show]="!terminated && !oneBloc && !(fileMagistor && errorfileMagistor)"></app-loader> -->
    <app-loader [width]="'100%'" [position]="'sticky'" [height]="'450px'" [bg]="'transparant'" [show]="showLoader">
    </app-loader>


    <div style="margin: 8px;">

      <!-------------------------------TYPE FILE ART--------------------------------------->
      <div *ngIf="typeFileART && !showLoader">
        <div *ngIf="terminated">

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Article : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid()"
                    [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid" [currentPage]="currentPageValid"
                  (changePage)="changePageValid($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log

                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                        *ngIf="fileMagistor?.rows.length!==0"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="fileMagistor?.rows.length==0">Pas de prestation</div>
                  <div *ngIf="advancedTableValid?.rows" class="content-table">
                    <table class="table-validator mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid?.columns ; let i = index"
                            id={{options[i].columnProp}} class="details-line mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>

                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions(options[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>

                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          (change)="selectDeleteRowValidFile (i)">
                        </mat-checkbox>

                      </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Conditionnement : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid2()"
                    [(ngModel)]="filterValue2" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid2" [currentPage]="currentPageValid2"
                  (changePage)="changePageValid2($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre2();$event.stopPropagation();' style="margin-left: 5px;"
                        *ngIf="fileMagistor2?.rows.length!==0"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="fileMagistor2?.rows.length==0">Pas de prestation</div>
                  <div *ngIf="advancedTableValid2?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid2?.columns ; let i = index"
                            id={{options2[i].columnProp}}2 class="details-line2 mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options2[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions2(options2[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options2[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid2?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                      <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                        (change)="selectDeleteRowValidFile (i)">
                      </mat-checkbox>

                    </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>

        </div>
        <div *ngIf="!terminated && oneBloc && fileMagistor && fileMagistor2">
          <app-prestation-erronee *ngIf="fileMagistor.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="fileMagistor" [data]="copyfileMagistor" [sheet1]="true" [oneBloc]="oneBloc"
            (changedDataEvent)="changedData($event)">
          </app-prestation-erronee>

          <app-prestation-erronee *ngIf="fileMagistor2.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="fileMagistor2" [data]="copyfileMagistor2" [sheet1]="false" [oneBloc]="oneBloc"
            (changedDataEvent)="changedData2($event)">
          </app-prestation-erronee>

        </div>
        <div *ngIf="!terminated && !oneBloc && fileMagistor && errorfileMagistor">
          <!------------------------------------- FEUILLE ART01 --------------------------------------->
          <!-------------------------------------------- PRESTATIONS VALIDEES --------------------------------------->

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Article : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid()"
                    [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid" [currentPage]="currentPageValid"
                  (changePage)="changePageValid($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log

                    </mat-panel-title>

                    <mat-panel-description>
                      <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                        *ngIf="fileMagistor?.rows.length!==0"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="fileMagistor?.rows.length==0">Pas de prestation</div>
                  <div *ngIf="advancedTableValid?.rows" class="content-table">
                    <table class="table-validator mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid?.columns ; let i = index"
                            id={{options[i].columnProp}} class="details-line mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions(options[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          (change)="selectDeleteRowValidFile (i)">
                        </mat-checkbox>

                      </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>
          <!------------------------------------- FEUILLE ART01 --------------------------------------->
          <!-------------------------------------------- PRESTATIONS ERRONEES --------------------------------------->
          <app-prestation-erronee *ngIf="errorfileMagistor?.rows?.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="errorfileMagistor" [data]="copyerrorfileMagistor" [sheet1]="true"
            (changedDataEvent)="changedData($event)">
          </app-prestation-erronee>
          <!------------------------------------- FEUILLE CND01 --------------------------------------->
          <!-------------------------------------------- PRESTATIONS VALIDEES --------------------------------------->

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Conditionnement : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid2()"
                    [(ngModel)]="filterValue2" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid2" [currentPage]="currentPageValid2"
                  (changePage)="changePageValid2($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre2();$event.stopPropagation();' style="margin-left: 5px;"
                        *ngIf="fileMagistor2?.rows.length!==0"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="fileMagistor2?.rows.length==0">Pas de prestation</div>
                  <div *ngIf="advancedTableValid2?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid2?.columns ; let i = index"
                            id={{options2[i].columnProp}}2 class="details-line2 mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options2[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions2(options2[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options2[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid2?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          (change)="selectDeleteRowValidFile (i)">
                        </mat-checkbox>

                      </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>
          <!------------------------------------- FEUILLE CND01 --------------------------------------->
          <!-------------------------------------------- PRESTATIONS ERRONEES --------------------------------------->
          <app-prestation-erronee *ngIf="errorfileMagistor2?.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="errorfileMagistor2" [data]="copyerrorfileMagistor2" [sheet1]="false"
            (changedDataEvent)="changedData2($event)">
          </app-prestation-erronee>
        </div>
      </div>

      <!-------------------------------TYPE FILE REC--------------------------------------->
      <div *ngIf="typeFileREC  && !showLoader">
        <div *ngIf="terminated">

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Réception : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid()"
                    [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>

                <base-pagination [numPage]="numPageValid" [currentPage]="currentPageValid"
                  (changePageREC)="changePageValid($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <app-loader [width]="'100%'" [position]="'sticky'" [height]="'450px'" [bg]="'transparant'"
                    [show]="!(fileMagistor )"></app-loader>

                  <div *ngIf="advancedTableValid?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid?.columns ; let i = index"
                            id={{options[i].columnProp}} class="details-line mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions(options[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                      <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                        (change)="selectDeleteRowValidFile (i)">
                      </mat-checkbox>

                    </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>

                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Lignes de réception : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid2()"
                    [(ngModel)]="filterValue2" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid2" [currentPage]="currentPageValid2"
                  (changePageREC)="changePageValid2($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre2();$event.stopPropagation();' style="margin-left: 5px;"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <app-loader [width]="'100%'" [position]="'sticky'" [height]="'450px'" [bg]="'transparant'"
                    [show]="!(fileMagistor2 )"></app-loader>

                  <div *ngIf="advancedTableValid2?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid2?.columns ; let i = index"
                            id={{options2[i].columnProp}}2 class="details-line2 mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options2[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions2(options2[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options2[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid2?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                    <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                      (change)="selectDeleteRowValidFile (i)">
                    </mat-checkbox>

                  </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>
        </div>

        <div *ngIf="!terminated && oneBloc && fileMagistor && fileMagistor2">
          <app-prestation-erronee [typeFile]="file?.logisticFileType" [originData]="fileMagistor"
            [data]="copyfileMagistor" [sheet1]="true" [oneBloc]="oneBloc" (changedDataEvent)="changedData($event)">
          </app-prestation-erronee>

          <app-prestation-erronee [typeFile]="file?.logisticFileType" [originData]="fileMagistor2"
            [data]="copyfileMagistor2" [sheet1]="false" [oneBloc]="oneBloc" (changedDataEvent)="changedData2($event)">
          </app-prestation-erronee>

        </div>

        <div *ngIf="!terminated && !oneBloc && fileMagistor && errorfileMagistor ">

          <!------------------------------------- FEUILLE REC01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS VALIDEES --------------------------------------->

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Réception : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid()"
                    [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid" [currentPage]="currentPageValid"
                  (changePage)="changePageValid($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="advancedTableValid?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid?.columns ; let i = index"
                            id={{options[i].columnProp}} class="details-line mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions(options[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          (change)="selectDeleteRowValidFile (i)">
                        </mat-checkbox>

                      </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>

                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>
          <!------------------------------------- FEUILLE REC01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS ERRONEES --------------------------------------->

          <app-prestation-erronee *ngIf="errorfileMagistor?.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="errorfileMagistor" [data]="copyerrorfileMagistor" [sheet1]="true"
            (changedDataEvent)="changedData($event)">
          </app-prestation-erronee>


          <!------------------------------------- FEUILLE LRC01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS VALIDEES --------------------------------------->

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Lignes de réception : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid2()"
                    [(ngModel)]="filterValue2" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid2" [currentPage]="currentPageValid2"
                  (changePage)="changePageValid2($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre2();$event.stopPropagation();' style="margin-left: 5px;"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>

                  <div *ngIf="advancedTableValid2?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid2?.columns ; let i = index"
                            id={{options2[i].columnProp}}2 class="details-line2 mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options2[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions2(options2[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options2[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid2?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          (change)="selectDeleteRowValidFile (i)">
                        </mat-checkbox>

                      </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>
          <!------------------------------------- FEUILLE LRC01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS ERRONEES --------------------------------------->

          <!-- <base-card *ngIf="false &&  typeFileREC"
        class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
        <base-card-title class="reorder">
          <div id="conteneur">
            <label class="label-wrong">Lignes de réception : Prestations erronées</label>
          </div>
          <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
            <div class="mdl-textfield label-search">
              <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItems()"
                [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
              <label class="mdl-textfield__label" for="search2"></label>
            </div>
          </div>
        </base-card-title>
        <base-card-body class="content-file-line">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Afficher Log
                </mat-panel-title>
                <mat-panel-description>
                  <button (click)='deleteRows("wrong");$event.stopPropagation();' id="deleteWrongBtn"
                    [disabled]=" rowsToDelete?.length==0 || alreadyClicked==true" style="margin-right: 5px;"
                    class=" delete-button mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal">Effacer
                  </button>
                  <button (click)='correctionFile();$event.stopPropagation();'
                    [disabled]="file?.wrongCommands == '_' ||  alreadyClicked==true"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button>
                  <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                    les filtres
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>

              <table mat-table id='mytable' *ngIf="typeFileREC" [dataSource]="copyfileMagistor" style
                class="table-rec mdl-data-table mdl-js-data-table  sorting-table" (keyup)="onKeyUp($event)">
                <ng-container matColumnDef="REMARQUE">
                  <th class="titre-column-magistor" id="REMARQUE" mat-header-cell *matHeaderCellDef>
                    REMARQUE
                  </th>
                  <td mat-cell *matCellDef="let element ;" id="REMARQUEmagistor"
                    class="center-cell-prestationsErronnees label-remarque"
                    >
                    {{element.REMARQUE}} </td>
                </ng-container>

                <ng-container matColumnDef="OP_CODE">
                  <th class="titre-column-magistor" id="OP_CODE" mat-header-cell *matHeaderCellDef> OP_CODE


                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[0].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[0],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[0].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="OP_CODEmagistor"
                    (mousedown)="onMouseDown(i, 0, 'OP_CODE')" (mouseup)="onMouseUp(i, 0, 'OP_CODE')"
                    [ngClass]="{'selected': selectedCellsState[i][0], 'unselected': !selectedCellsState[i][0]}">
                    {{element.OP_CODE}} </td>
                </ng-container>

                <ng-container matColumnDef="OP_ACTION">
                  <th class="titre-column-magistor" id="OP_ACTION" mat-header-cell *matHeaderCellDef> OP_ACTION

                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[1].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[1],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[1].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="OP_ACTIONmagistor"
                    (mousedown)="onMouseDown(i, 1, 'OP_ACTION')" (mouseup)="onMouseUp(i, 1, 'OP_ACTION')"
                    [ngClass]="{'selected': selectedCellsState[i][1], 'unselected': !selectedCellsState[i][1]}">
                    {{element.OP_ACTION}} </td>
                </ng-container>

                <ng-container matColumnDef="CODE_SOC">
                  <th class="titre-column-magistor" id="CODE_SOC" mat-header-cell *matHeaderCellDef>
                    CODE_SOC

                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[2].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[2],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[2].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="CODE_SOCmagistor"
                    (mousedown)="onMouseDown(i, 2, 'CODE_SOC')" (mouseup)="onMouseUp(i, 2, 'CODE_SOC')"
                    [ngClass]="{'selected': selectedCellsState[i][2], 'unselected': !selectedCellsState[i][2]}">
                    {{element.CODE_SOC}}
                  </td>
                </ng-container>


                <ng-container matColumnDef="CODE_FRN">
                  <th class="titre-column-magistor" id="CODE_FRN" mat-header-cell *matHeaderCellDef> CODE_FRN

                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[3].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[3],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[3].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="CODE_FRNmagistor"
                    (mousedown)="onMouseDown(i, 3, 'CODE_FRN')" (mouseup)="onMouseUp(i, 3, 'CODE_FRN')"
                    [ngClass]="{'selected': selectedCellsState[i][3], 'unselected': !selectedCellsState[i][3]}">
                    {{element.CODE_FRN}} </td>
                </ng-container>


                <ng-container matColumnDef="N_PIECE">
                  <th class="titre-column-magistor" id="N_PIECE" mat-header-cell *matHeaderCellDef> N_PIECE

                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[4].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[4],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[4].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="N_PIECEmagistor"
                    (mousedown)="onMouseDown(i, 4, 'N_PIECE')" (mouseup)="onMouseUp(i, 4, 'N_PIECE')"
                    [ngClass]="{'selected': selectedCellsState[i][4], 'unselected': !selectedCellsState[i][4]}">
                    {{element.N_PIECE}} </td>
                </ng-container>


                <ng-container matColumnDef="TYPE_RECEP">
                  <th class="titre-column-magistor" id="TYPE_RECEP" mat-header-cell *matHeaderCellDef> TYPE_RECEP

                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[5].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[5],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[5].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="TYPE_RECEPmagistor"
                    (mousedown)="onMouseDown(i, 5, 'TYPE_RECEP')" (mouseup)="onMouseUp(i, 5, 'TYPE_RECEP')"
                    [ngClass]="{'selected': selectedCellsState[i][5], 'unselected': !selectedCellsState[i][5]}">
                    {{element.TYPE_RECEP}} </td>
                </ng-container>

                <ng-container matColumnDef="REF_COMMANDE">
                  <th class="titre-column-magistor" id="REF_COMMANDE" mat-header-cell *matHeaderCellDef> REF_COMMANDE

                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[6].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[6],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[6].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="REF_COMMANDEmagistor"
                    (mousedown)="onMouseDown(i, 6, 'REF_COMMANDE')" (mouseup)="onMouseUp(i, 6, 'REF_COMMANDE')"
                    [ngClass]="{'selected': selectedCellsState[i][6], 'unselected': !selectedCellsState[i][6]}">
                    {{element.REF_COMMANDE}} </td>
                </ng-container>


                <ng-container matColumnDef="DATE_ATTENDUE">
                  <th class="titre-column-magistor" id="DATE_ATTENDUE" mat-header-cell *matHeaderCellDef> DATE_ATTENDUE

                    <mat-form-field class="form-column" appearance="fill">
                      <mat-select multiple [(ngModel)]="options[7].modelValue"
                        (selectionChange)="setFilteredItemsOptions(options[7],$event)">
                        <mat-select-trigger>
                        </mat-select-trigger>
                        <mat-option *ngFor="let item of options[7].options" [value]="item">{{item}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </th>
                  <td mat-cell *matCellDef="let element ; let i = index" id="DATE_ATTENDUEmagistor"
                    (mousedown)="onMouseDown(i, 7, 'DATE_ATTENDUE')" (mouseup)="onMouseUp(i, 7, 'DATE_ATTENDUE')"
                    [ngClass]="{'selected': selectedCellsState[i][7], 'unselected': !selectedCellsState[i][7]}">
                    {{element.DATE_ATTENDUE}}
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns ; sticky: true">

                </tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              </table>
            </mat-expansion-panel>

          </mat-accordion>
        </base-card-body>
      </base-card> -->

          <app-prestation-erronee *ngIf="errorfileMagistor2?.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="errorfileMagistor2" [data]="copyerrorfileMagistor2" [sheet1]="false"
            (changedDataEvent)="changedData2($event)">
          </app-prestation-erronee>
        </div>
      </div>

      <!-------------------------------TYPE FILE CDC--------------------------------------->
      <div *ngIf="typeFileCDC  && !showLoader">
        <div *ngIf="terminated">
          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Commandes : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid()"
                    [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid" [currentPage]="currentPageValid"
                  (changePage)="changePageValid($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="advancedTableValid?.rows" class="content-table">
                    <table class="table-validator mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid?.columns ; let i = index"
                            id={{options[i].columnProp}} class="details-line mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions(options[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                    <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                      (change)="selectDeleteRowValidFile (i)">
                    </mat-checkbox>

                  </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>

                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>


          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Lignes de commandes : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid2()"
                    [(ngModel)]="filterValue2" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid2" [currentPage]="currentPageValid2"
                  (changePage)="changePageValid2($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre2();$event.stopPropagation();' style="margin-left: 5px;"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>

                  <div *ngIf="advancedTableValid2?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid2?.columns ; let i = index"
                            id={{options2[i].columnProp}}2 class="details-line2 mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options2[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions2(options2[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options2[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid2?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                  <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                    (change)="selectDeleteRowValidFile (i)">
                  </mat-checkbox>

                </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>

        </div>

        <div *ngIf="!terminated && oneBloc && fileMagistor && fileMagistor2">
          <app-prestation-erronee *ngIf="fileMagistor.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="fileMagistor" [data]="copyfileMagistor" [sheet1]="true" [oneBloc]="oneBloc"
            (changedDataEvent)="changedData($event)">
          </app-prestation-erronee>

          <app-prestation-erronee *ngIf="fileMagistor2.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="fileMagistor2" [data]="copyfileMagistor2" [sheet1]="false" [oneBloc]="oneBloc"
            (changedDataEvent)="changedData2($event)">
          </app-prestation-erronee>

        </div>

        <div *ngIf="!terminated && !oneBloc && fileMagistor && errorfileMagistor">
          <!------------------------------------- FEUILLE CDC01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS VALIDEES --------------------------------------->

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Commandes : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid()"
                    [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid" [currentPage]="currentPageValid"
                  (changePage)="changePageValid($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                        *ngIf="fileMagistor?.rows.length!==0"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="fileMagistor?.rows.length==0">Pas de prestation</div>
                  <div *ngIf="advancedTableValid?.rows" class="content-table">
                    <table class="table-validator mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid?.columns ; let i = index"
                            id={{options[i].columnProp}} class="details-line mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions(options[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          (change)="selectDeleteRowValidFile (i)">
                        </mat-checkbox>

                      </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>

                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>
          <!------------------------------------- FEUILLE CDC01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS ERRONEES --------------------------------------->

          <app-prestation-erronee *ngIf="errorfileMagistor?.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="errorfileMagistor" [data]="copyerrorfileMagistor" [sheet1]="true" [oneBloc]="false"
            (changedDataEvent)="changedData($event)">
          </app-prestation-erronee>
          <!------------------------------------- FEUILLE LCD01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS VALIDEES --------------------------------------->

          <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
            <base-card-title class="reorder">
              <div id="conteneur">
                <label class="label-success">Lignes de commandes : Prestations validées</label>
              </div>
              <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
                <div class="mdl-textfield label-search">
                  <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsValid2()"
                    [(ngModel)]="filterValue2" placeholder="Rechercher" autocomplete="off" />
                  <label class="mdl-textfield__label" for="search2"></label>
                </div>
                <base-pagination [numPage]="numPageValid2" [currentPage]="currentPageValid2"
                  (changePage)="changePageValid2($event)">
                </base-pagination>
              </div>
            </base-card-title>
            <base-card-body class="content-file-line">
              <mat-accordion>
                <mat-expansion-panel hideToggle>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      Afficher Log
                    </mat-panel-title>
                    <mat-panel-description>
                      <button (click)='resetFiltre2();$event.stopPropagation();' style="margin-left: 5px;"
                        *ngIf="fileMagistor2?.rows.length!==0"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                        les filtres
                      </button>
                    </mat-panel-description>
                  </mat-expansion-panel-header>
                  <div *ngIf="fileMagistor2?.rows.length==0">Pas de prestation</div>
                  <div *ngIf="advancedTableValid2?.rows" class="content-table">
                    <table class="table-width-100 mdl-data-table mdl-js-data-table  sorting-table">
                      <thead>
                        <tr>
                          <th *ngFor="let row of advancedTableValid2?.columns ; let i = index"
                            id={{options2[i].columnProp}}2 class="details-line2 mdl-data-table__cell--non-numeric">
                            <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                            <mat-form-field class="form-column" appearance="fill">
                              <mat-select multiple [(ngModel)]="options2[i].modelValue"
                                (selectionChange)="setFilteredItemsOptions2(options2[i],$event)">
                                <mat-select-trigger>
                                </mat-select-trigger>
                                <mat-option *ngFor="let item of options2[i].options" [value]="item">{{item}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr *ngFor="let item of advancedTableValid2?.rows  | slice:0:limit; let i = index;">
                          <!-- <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          (change)="selectDeleteRowValidFile (i)">
                        </mat-checkbox>

                      </td> -->

                          <td *ngFor="let column of item; let j=index; trackBy:customTrackBy" [ngClass]="full-column"
                            class="details-line mdl-data-table__cell--non-numeric">
                            <label [ngClass]="full-column">
                              {{column}}
                            </label>
                          </td>
                        </tr>
                      </tbody>

                    </table>
                  </div>
                </mat-expansion-panel>

              </mat-accordion>
            </base-card-body>
          </base-card>
          <!------------------------------------- FEUILLE LCD01  --------------------------------------->
          <!-------------------------------------------- PRESTATIONS ERRONEES --------------------------------------->

          <app-prestation-erronee *ngIf="errorfileMagistor2?.rows.length > 0" [typeFile]="file?.logisticFileType"
            [originData]="errorfileMagistor2" [data]="copyerrorfileMagistor2" [sheet1]="false" [oneBloc]="false"
            (changedDataEvent)="changedData2($event)">
          </app-prestation-erronee>
        </div>
      </div>
    </div>

  </div>
</div>