<div class="container mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
  <div class="content-file-edi">
    <div class="content-labels">
      <base-card class="mdl-cell mdl-cell--10-col-desktop mdl-cell--10-col-tablet mdl-cell--5-col-phone">
        <base-card-body class="content-first-card ">
          <div class="content-label">
            <label class="details-label-header">Statut</label>
            <label class="details-label">{{file?.status}}</label>
          </div>
          <div class="content-label">
            <label class="details-label-header">Date</label>
            <label class="details-label">{{file?.createdAt| date:"dd/MM/yyyy 'à' HH:mm"}}</label>
          </div>
          <div class="content-label">
            <label class="details-label-header">Nom fichier</label>
            <label class="details-label">{{file?.fileName}}</label>
          </div>
          <div class="content-label">
            <label class="details-label-header">Code client</label>
            <label class="details-label">{{file?.contact.codeClient}}</label>
          </div>
          <div class="content-label">
            <label class="details-label-header">Nombre des prestations erronées</label>
            <label *ngIf='!fileWrong?.rows' class="label-wrong">- </label>
            <label *ngIf='fileWrong?.rows' class="label-wrong">{{fileWrong.rows.length || 0}} </label>
          </div>
          <div class="content-label">
            <label class="details-label-header">Nombre des prestations validées</label>
            <label *ngIf='!fileValid?.rows' class="label-success">- </label>
            <label *ngIf='fileValid?.rows' class="label-success">{{fileValid?.rows?.length || 0}} </label>

          </div>
        </base-card-body>
      </base-card>
      <div *ngIf="file" style='text-align: center;'
        class="mdl-cell mdl-cell--2-col-desktop mdl-cell--2-col-tablet mdl-cell--1-col-phone">
        <button [disabled]="file?.number_wrong_commands>0||fileWrong?.rows?.length>0 || file?.sendedToUrbantz==true"
          id="sendToUrbantz" (click)="sendFileToUrbantz();"
          class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Envoyer
          à Urbantz
        </button>
      </div>
    </div>

    <div class="content-labels">
      <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
        <base-card-title class="reorder-edi">
          <div id="conteneur">
            <label class="label-success">Prestations validées</label>
          </div>
          <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
            <div class="mdl-textfield label-search">
              <input class="mdl-textfield__input" type="text" id="search1" (input)="setFilteredItemsValid()"
                [(ngModel)]="filterValueValid" placeholder="Rechercher" autocomplete="off" />
              <label class="mdl-textfield__label" for="search1"></label>
            </div>
          </div>
        </base-card-title>
        <base-card-body class="content-file-line">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Afficher Log
                </mat-panel-title>
                <mat-panel-description>
                  <button (click)='deleteRows("valid");$event.stopPropagation();' id="deleteValidBtn" style="margin-right: 5px;"
                    [disabled]=" rowsToDeleteValid?.length==0 || alreadyClicked==true" color="warn"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal delete-button">Effacer
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                [show]="showValid"></app-loader>
              <div *ngIf="fileValid?.columns && fileValid?.rows.length>0" class="content-table">
                <table class="table-validator mdl-data-table mdl-js-data-table  sorting-table">
                  <thead>
                    <tr>
                      <!-- <th class="header-actif" mat-header-cell id="selectDelete-header" *matHeaderCellDef>  À supprimer
                        <mat-checkbox  style="margin-left:5px"
                          (change)="$event ? deleteMasterToggle() : null"
                          [checked]=" rowsToDelete.length == copyFileWrong.length"
                           >
                        </mat-checkbox>
                       
                      </th> -->
                      <th *ngFor="let row of fileValid?.columns ; let i = index"
                        class="details-line mdl-data-table__cell--non-numeric">
                        <span *ngIf="row !=='Delete' && row !=='rowId'&& row !=='selected' ">{{row}}</span>
                        <span *ngIf="row =='Delete'">
                          À supprimer
                          <mat-checkbox style="margin-left:5px" (change)="$event ? deleteMasterToggleValid() : null"
                          [checked]=" rowsToDeleteValid.length == copyFileValid.length"
                          >
                          </mat-checkbox>
                        </span>
                      </th>
                    </tr>
                  </thead>
                  <tbody>

                    <tr *ngFor="let item of fileValid?.rows  | slice:0:limit; let i = index;">
                      <td>
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                        [checked]=" isRowValidSelected(i)"
                          (change)="selectDeleteRowValidFile (i)">
                          <!-- (click)="$event.stopPropagation()"
                        [checked]=" isRowSelected(element.rowId)" (change)="selectDeleteRow (element.rowId)" -->
                        </mat-checkbox>

                      </td>

                      <td *ngFor="let column of item; let j=index; trackBy:customTrackBy"
                        [ngClass]="(j==9 || j==10 || j==11 ||j==16 || j==21)?'remarque-column':'full-column'"
                        class="details-line mdl-data-table__cell--non-numeric">
                        <label *ngIf="j!==28 && j!==29"
                          [ngClass]="(j==4 || j==5|| j==6||j==7 || j==12  )?'mini-column':'full-column'">{{column}}</label>
                      </td>
                    </tr>
                  </tbody>

                </table>
              </div>
            </mat-expansion-panel>

          </mat-accordion>
        </base-card-body>
      </base-card>
    </div>

    <div>
      <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
        <base-card-title class="reorder-edi ">
          <div id="conteneur">
            <label class="label-wrong">Prestations erronées</label>
          </div>
          <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
            <div class="mdl-textfield label-search">
              <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItems()"
                [(ngModel)]="filterValue" placeholder="Rechercher" autocomplete="off" />
              <label class="mdl-textfield__label" for="search2"></label>
            </div>
          </div>
        </base-card-title>
        <base-card-body class="content-file-line">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Afficher Log
                </mat-panel-title>
                <mat-panel-description>
                  <button (click)='deleteRows("wrong");$event.stopPropagation();' id="deleteWrongBtn"
                    [disabled]=" rowsToDelete?.length==0 || alreadyClicked==true" style="margin-right: 5px;"
                    class=" delete-button mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal">Effacer
                  </button>
                  <button (click)='correctionFile();$event.stopPropagation();'
                    [disabled]="file?.wrongCommands == '_' ||  alreadyClicked==true"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button>
                  <button (click)='resetFiltre();$event.stopPropagation();' style="margin-left: 5px;"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                    les filtres
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                [show]="showWrong"></app-loader>
              <div *ngIf="copyFileWrong" class="content-table">
                <table mat-table id='mytable' [dataSource]="copyFileWrong"
                  class="table-validator mdl-data-table mdl-js-data-table  sorting-table" (keyup)="onKeyUp($event,this)">
                  <!-- Delete Column -->

                  <ng-container matColumnDef="Delete">
                    <th class="header-actif" mat-header-cell id="selectDelete-header" *matHeaderCellDef> À supprimer
                      <mat-checkbox style="margin-left:5px" (change)="$event ? deleteMasterToggle() : null"
                        [checked]=" rowsToDelete.length == copyFileWrong.length">
                      </mat-checkbox>

                    </th>

                    <td mat-cell *matCellDef="let element; let j = index">
                      <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                        [checked]=" isRowSelected(element.rowId)" (change)="selectDeleteRow (element.rowId)">
                      </mat-checkbox>

                    </td>
                  </ng-container>

                  <ng-container matColumnDef="Remarque">
                    <th class="titre-column" mat-header-cell id="Remarque-header" *matHeaderCellDef> Remarque
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[1].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[1],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[1].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                    </th>
                    <td mat-cell *matCellDef="let element" class="center-cell-prestationsErronnees label-remarque">
                      {{element.Remarque}} </td>
                  </ng-container>

                  <ng-container matColumnDef="selected">
                    <th class="header-actif" mat-header-cell id="selected-header" *matHeaderCellDef>Actif
                      <mat-checkbox style="margin-left:5px" (change)="$event ? masterToggle() : null"
                        [checked]="selectionCh.hasValue() && isAllSelected()"
                        [indeterminate]="selectionCh.hasValue() && !isAllSelected()">
                      </mat-checkbox>
                    </th>
                    <!-- (change)="onCheckboxStateChange(element)"  -->
                    <td mat-cell *matCellDef="let element; let i = index">
                      <mat-checkbox (click)="$event.stopPropagation()"
                        [checked]="element.selected==1 || selectionCh.isSelected(element)"
                        (change)="$event ? selectionCh.toggle(element) : null;onCheckboxStateChange(element)"
                        *ngIf="element.Remarque_id == 6">
                      </mat-checkbox>

                    </td>
                  </ng-container>
                  <ng-container matColumnDef="RefClient">
                    <th class="titre-column" mat-header-cell id="RefClient-header" *matHeaderCellDef> RefClient
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[3].columnProp}}"
                          [(ngModel)]="options[3].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[3],$event)">
                          <mat-option value="">-- Select {{options[3].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[3].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->

                      <mat-form-field class="form-column" appearance="fill" >
                        <mat-select multiple [(ngModel)]="options[3].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[3],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[3].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="RefClient"
                      (mousedown)="onMouseDown(i, 3, 'RefClient')" (mouseup)="onMouseUp(i, 3, 'RefClient')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][3], 'unselected': !selectedCellsState[i][3],'error': (element.Remarque_id==13 || element.Remarque_id==14 )}">
                      {{getRefClient(element)}} </td>
                  </ng-container>


                  <ng-container matColumnDef="Expediteur">
                    <th class="titre-column" mat-header-cell id="Expediteur-header" *matHeaderCellDef> Expediteur
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[4].columnProp}}"
                          [(ngModel)]="options[4].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[4],$event)">
                          <mat-option value="">-- Select {{options[4].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[4].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->

                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[4].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[4],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[4].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Expediteur"
                      (mousedown)="onMouseDown(i, 4, 'Expediteur')" (mouseup)="onMouseUp(i, 4, 'Expediteur')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][4], 'unselected': !selectedCellsState[i][4], 'error': element.Remarque_id==1}">
                      {{getExpediteur(element)}} </td>
                  </ng-container>


                  <ng-container matColumnDef="Type">
                    <th class="titre-column" mat-header-cell id="Type-header" *matHeaderCellDef> Type
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[5].columnProp}}"
                          [(ngModel)]="options[5].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[5],$event)">
                          <mat-option value="">-- Select {{options[5].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[5].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[5].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[5],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[5].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                    </th>
                    <td mat-cell id="Type" class="center-cell-prestationsErronnees"
                      (mousedown)="onMouseDown(i, 5, 'Type')" (mouseup)="onMouseUp(i, 5, 'Type')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][5], 'unselected': !selectedCellsState[i][5], 'error': element.Remarque_id==17}">
                      {{getType(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Date_livraison">
                    <th class="titre-column" mat-header-cell id="Date_livraison-header" *matHeaderCellDef>
                      Date_livraison
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[6].columnProp}}"
                          [(ngModel)]="options[6].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[6],$event)">
                          <mat-option value="">-- Select {{options[6].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[6].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[6].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[6],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[6].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Date_livraison"
                      (mousedown)="onMouseDown(i, 6, 'Date_livraison')" (mouseup)="onMouseUp(i, 6, 'Date_livraison')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][6], 'unselected': !selectedCellsState[i][6], 'error': (element.Remarque_id==3 ||element.Remarque_id==20|| element.Remarque_id==6)}">
                      {{element.Date_livraison}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Start">
                    <th class="titre-column" mat-header-cell id="Start-header" *matHeaderCellDef> Start
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[7].columnProp}}"
                          [(ngModel)]="options[7].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[7],$event)">
                          <mat-option value="">-- Select {{options[7].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[7].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[7].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[7],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[7].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Start"
                      (mousedown)="onMouseDown(i, 7, 'Start')" (mouseup)="onMouseUp(i, 7, 'Start')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][7], 'unselected': !selectedCellsState[i][7], 'error': (element.Remarque_id==5 ||element.Remarque_id==6)}">
                      {{getStart(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="End">
                    <th class="titre-column" mat-header-cell id="End-header" *matHeaderCellDef> End
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[8].columnProp}}"
                          [(ngModel)]="options[8].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[8],$event)">
                          <mat-option value="">-- Select {{options[8].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[8].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[8].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[8],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[8].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="End"
                      (mousedown)="onMouseDown(i, 8, 'End')" (mouseup)="onMouseUp(i, 8, 'End')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][8], 'unselected': !selectedCellsState[i][8], 'error': element.Remarque_id==7}">
                      {{getEnd(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Labels">
                    <th class="titre-column" mat-header-cell id="Labels-header" *matHeaderCellDef> Labels
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[9].columnProp}}"
                          [(ngModel)]="options[9].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[9],$event)">
                          <mat-option value="">-- Select {{options[9].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[9].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->

                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[9].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[9],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[9].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Labels"
                      (mousedown)="onMouseDown(i, 9, 'Labels')" (mouseup)="onMouseUp(i, 9, 'Labels')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][9], 'unselected': !selectedCellsState[i][9], 'error': element.Remarque_id==18 }">
                      {{getLabels(element)}} </td>
                  </ng-container>
                  <ng-container matColumnDef="Quantite">
                    <th class="titre-column" mat-header-cell id="Quantite-header" *matHeaderCellDef> Quantite
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[10].columnProp}}"
                          [(ngModel)]="options[10].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[10],$event)">
                          <mat-option value="">-- Select {{options[10].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[10].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[10].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[10],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[10].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Quantite"
                      (mousedown)="onMouseDown(i, 10, 'Quantite')" (mouseup)="onMouseUp(i, 10, 'Quantite')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][10], 'unselected': !selectedCellsState[i][10], 'error': element.Remarque_id==4}">
                      {{getQuantite(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="CodeArticle">
                    <th class="titre-column" mat-header-cell id="CodeArticle-header" *matHeaderCellDef> CodeArticle
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[11].columnProp}}"
                          [(ngModel)]="options[11].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[11],$event)">
                          <mat-option value="">-- Select {{options[11].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[11].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[11].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[11],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[11].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="CodeArticle"
                      (mousedown)="onMouseDown(i, 11, 'CodeArticle')" (mouseup)="onMouseUp(i, 11, 'CodeArticle')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][11], 'unselected': !selectedCellsState[i][11]}">
                      {{element.CodeArticle}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Nom_destinataire">
                    <th class="titre-column" mat-header-cell id="Nom_destinataire-header" *matHeaderCellDef>
                      Nom_destinataire
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[12].columnProp}}"
                          [(ngModel)]="options[12].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[12],$event)">
                          <mat-option value="">-- Select {{options[12].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[12].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[12].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[12],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[12].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Nom_destinataire"
                      (mousedown)="onMouseDown(i, 12, 'Nom_destinataire')"
                      (mouseup)="onMouseUp(i, 12, 'Nom_destinataire')" *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][12], 'unselected': !selectedCellsState[i][12], 'error': element.Remarque_id==8 }">
                      {{getNomDestinataire(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="rue">
                    <th class="titre-column" mat-header-cell id="rue-header" *matHeaderCellDef> rue
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[13].columnProp}}"
                          [(ngModel)]="options[13].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[13],$event)">
                          <mat-option value="">-- Select {{options[13].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[13].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[13].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[13],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[13].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="rue"
                      (mousedown)="onMouseDown(i, 13, 'rue')" (mouseup)="onMouseUp(i, 13, 'rue')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][13], 'unselected': !selectedCellsState[i][13], 'error': element.Remarque_id==9}">
                      {{getRue(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="ville">
                    <th class="titre-column" mat-header-cell id="ville-header" *matHeaderCellDef> ville
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[14].columnProp}}"
                          [(ngModel)]="options[14].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[14],$event)">
                          <mat-option value="">-- Select {{options[14].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[14].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[14].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[14],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[14].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="ville"
                      (mousedown)="onMouseDown(i, 14, 'ville')" (mouseup)="onMouseUp(i, 14, 'ville')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][14], 'unselected': !selectedCellsState[i][14], 'error': element.Remarque_id==10}">
                      {{getVille(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="CP">
                    <th class="titre-column" mat-header-cell id="CP-header" *matHeaderCellDef> CP
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[15].columnProp}}"
                          [(ngModel)]="options[15].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[15],$event)">
                          <mat-option value="">-- Select {{options[15].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[15].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[15].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[15],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[15].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="CP" (mousedown)="onMouseDown(i, 15, 'CP')"
                      (mouseup)="onMouseUp(i, 15, 'CP')" *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][15], 'unselected': !selectedCellsState[i][15], 'error': element.Remarque_id==2 ||element.Remarque_id==21}">
                      {{getCP(element)}} </td>
                  </ng-container>
                  <ng-container matColumnDef="Adresse2">
                    <th class="titre-column" mat-header-cell id="Adresse2-header" *matHeaderCellDef> Adresse2
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[16].columnProp}}"
                          [(ngModel)]="options[16].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[16],$event)">
                          <mat-option value="">-- Select {{options[16].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[16].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[16].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[16],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[16].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Adresse2"
                      (mousedown)="onMouseDown(i, 16, 'Adresse2')" (mouseup)="onMouseUp(i, 16, 'Adresse2')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][16], 'unselected': !selectedCellsState[i][16]}">
                      {{element.Adresse2}} </td>
                  </ng-container>

                  <ng-container matColumnDef="CODE_interphone">
                    <th class="titre-column" mat-header-cell id="CODE_interphone-header" *matHeaderCellDef>
                      CODE_interphone
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[17].columnProp}}"
                          [(ngModel)]="options[17].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[17],$event)">
                          <mat-option value="">-- Select {{options[17].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[17].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[17].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[17],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[17].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="CODE_interphone"
                      (mousedown)="onMouseDown(i, 17, 'CODE_interphone')"
                      (mouseup)="onMouseUp(i, 17, 'CODE_interphone')" *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][17], 'unselected': !selectedCellsState[i][17]}">
                      {{element.CODE_interphone}} </td>
                  </ng-container>
                  <ng-container matColumnDef="Etage">
                    <th class="titre-column" mat-header-cell id="Etage-header" *matHeaderCellDef> Etage
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[18].columnProp}}"
                          [(ngModel)]="options[18].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[18],$event)">
                          <mat-option value="">-- Select {{options[18].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[18].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[18].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[18],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[18].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Etage"
                      (mousedown)="onMouseDown(i, 18, 'Etage')" (mouseup)="onMouseUp(i, 18, 'CODE_interphone')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][18], 'unselected': !selectedCellsState[i][18]}">
                      {{element.Etage}} </td>
                  </ng-container>
                  <ng-container matColumnDef="Porte">
                    <th class="titre-column" mat-header-cell id="Porte-header" *matHeaderCellDef> Porte
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[19].columnProp}}"
                          [(ngModel)]="options[19].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[19],$event)">
                          <mat-option value="">-- Select {{options[19].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[19].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[19].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[19],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[19].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Porte"
                      (mousedown)="onMouseDown(i, 19, 'Porte')" (mouseup)="onMouseUp(i, 19, 'Porte')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][19], 'unselected': !selectedCellsState[i][19]}">
                      {{element.Porte}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Instructions">
                    <th class="titre-column" mat-header-cell id="Instructions-header" *matHeaderCellDef> Instructions
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[20].columnProp}}"
                          [(ngModel)]="options[20].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[20],$event)">
                          <mat-option value="">-- Select {{options[20].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[20].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[20].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[20],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[20].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Instructions"
                      (mousedown)="onMouseDown(i, 20, 'Instructions')" (mouseup)="onMouseUp(i, 20, 'Instructions')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][20], 'unselected': !selectedCellsState[i][20]}">
                      {{element.Instructions}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Telephone">
                    <th class="titre-column" mat-header-cell id="Telephone-header" *matHeaderCellDef> Telephone
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[21].columnProp}}"
                          [(ngModel)]="options[21].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[21],$event)">
                          <mat-option value="">-- Select {{options[21].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[21].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[21].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[21],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[21].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Telephone"
                      (mousedown)="onMouseDown(i, 21, 'Telephone')" (mouseup)="onMouseUp(i, 21, 'Telephone')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][21], 'unselected': !selectedCellsState[i][21]}">
                      {{element.Telephone}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Tel2">
                    <th class="titre-column" mat-header-cell id="Tel2-header" *matHeaderCellDef> Tel2
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[22].columnProp}}"
                          [(ngModel)]="options[22].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[22],$event)">
                          <mat-option value="">-- Select {{options[22].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[22].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[22].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[22],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[22].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Tel2"
                      (mousedown)="onMouseDown(i, 22, 'Tel2')" (mouseup)="onMouseUp(i, 22, 'Tel2')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][22], 'unselected': !selectedCellsState[i][22]}">
                      {{element.Tel2}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Tel3">
                    <th class="titre-column" mat-header-cell id="Tel3-header" *matHeaderCellDef> Tel3
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[23].columnProp}}"
                          [(ngModel)]="options[23].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[23],$event)">
                          <mat-option value="">-- Select {{options[23].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[23].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[23].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[23],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[23].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Tel3"
                      (mousedown)="onMouseDown(i, 23, 'Tel3')" (mouseup)="onMouseUp(i, 23, 'Tel3')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][23], 'unselected': !selectedCellsState[i][23]}">
                      {{element.Tel3}} </td>
                  </ng-container>

                  <ng-container matColumnDef="email">
                    <th class="titre-column" mat-header-cell id="email-header" *matHeaderCellDef> email
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[24].columnProp}}"
                          [(ngModel)]="options[24].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[24],$event)">
                          <mat-option value="">-- Select {{options[24].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[24].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[24].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[24],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[24].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="email"
                      (mousedown)="onMouseDown(i, 24, 'email')" (mouseup)="onMouseUp(i, 24, 'email')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][24], 'unselected': !selectedCellsState[i][24]}">
                      {{element.email}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Ref_commande">
                    <th class="titre-column" mat-header-cell id="Ref_commande-header" *matHeaderCellDef> Ref_commande
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[25].columnProp}}"
                          [(ngModel)]="options[25].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[25],$event)">
                          <mat-option value="">-- Select {{options[25].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[25].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[25].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[25],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[25].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Ref_commande"
                      (mousedown)="onMouseDown(i, 25, 'Ref_commande')" (mouseup)="onMouseUp(i, 25, 'Ref_commande')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][25], 'unselected': !selectedCellsState[i][25]}">
                      {{element.Ref_commande}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Ref2">
                    <th class="titre-column" mat-header-cell id="Ref2-header" *matHeaderCellDef> Ref2
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[26].columnProp}}"
                          [(ngModel)]="options[26].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[26],$event)">
                          <mat-option value="">-- Select {{options[26].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[26].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[26].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[26],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[26].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Ref2"
                      (mousedown)="onMouseDown(i, 26, 'Ref2')" (mouseup)="onMouseUp(i, 26, 'Ref2')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][26], 'unselected': !selectedCellsState[i][26], 'error': (element.Remarque_id==19||element.Remarque_id==11)}">
                      {{getRef2(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Ref3">
                    <th class="titre-column" mat-header-cell id="Ref3-header" *matHeaderCellDef> Ref3
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[27].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[27],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[27].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Ref3"
                      (mousedown)="onMouseDown(i, 27, 'Ref3')" (mouseup)="onMouseUp(i, 27, 'Ref3')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][27], 'unselected': !selectedCellsState[i][27], 'error': element.Remarque_id==12}">
                      {{getRef3(element)}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Code_barres">
                    <th class="titre-column" mat-header-cell id="Code_barres-header" *matHeaderCellDef> Code_barres
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[28].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[28],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[28].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Code_barres"
                      (mousedown)="onMouseDown(i, 28, 'Code_barres')" (mouseup)="onMouseUp(i, 28, 'Code_barres')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][28], 'unselected': !selectedCellsState[i][28]}">
                      {{element.Code_barres}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Nom_tournee">
                    <th class="titre-column" mat-header-cell id="Nom_tournee-header" *matHeaderCellDef> Nom_tournee
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[29].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[29],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[29].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Nom_tournee"
                      (mousedown)="onMouseDown(i, 29, 'Nom_tournee')" (mouseup)="onMouseUp(i, 29, 'Nom_tournee')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][29], 'unselected': !selectedCellsState[i][29]}">
                      {{element.Nom_tournee}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Arret">
                    <th class="titre-column" mat-header-cell id="Arret-header" *matHeaderCellDef> Arret
                      <!-- <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{options[30].columnProp}}"
                          [(ngModel)]="options[30].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[30],$event)">
                          <mat-option value="">-- Select {{options[30].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of options[30].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select multiple [(ngModel)]="options[30].modelValue"
                          (selectionChange)="setFilteredItemsOptions(options[30],$event)">
                          <mat-select-trigger>
                          </mat-select-trigger>
                          <mat-option *ngFor="let item of options[30].options" [value]="item">{{item}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-prestationsErronnees" id="Arret"
                      (mousedown)="onMouseDown(i, 30, 'Arret')" (mouseup)="onMouseUp(i, 30, 'Arret')"
                      *matCellDef="let element; let i = index"
                      [ngClass]="{'selected': selectedCellsState[i][30], 'unselected': !selectedCellsState[i][30]}">
                      {{element.Arret}} </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumns ; sticky: true">

                  </tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
              </div>
            </mat-expansion-panel>

          </mat-accordion>
        </base-card-body>
      </base-card>

    </div>

  </div>
</div>