<div class="container-transaction mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
  <!-- <app-loader [width]="'100%'" [position]="'sticky'"  [height]="'450px'" [bg]="'transparant'" [show]="show"></app-loader> -->
  <div class="content-file-edi">
    <!-- <div style="text-align: left;padding-left: inherit;"
      class="mdl-cell mdl-cell--5-col-desktop mdl-cell--5-col-tablet mdl-cell--2-col-phone">
      <label class="number-transaction ">Transaction {{transaction?.transaction_id}}</label>
    </div> -->
    <div class="content-labels" id="conteneur">
      <!--            <div class="element 1">-->
      <base-card class="element-1"
        class="mdl-cell mdl-cell--5-col-desktop mdl-cell--5-col-tablet mdl-cell--2-col-phone">
        <base-card-body class="content-card">
          <div class="content-label">
            <label class="details-label">Statut</label>
            <label *ngIf="transaction" class="details-label">{{transaction?.statut}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
          <div class="content-label">
            <label  class="details-label">Date Début </label>
            <label *ngIf="transaction" class="details-label">{{transaction?.start_date | date:"yyyy-MM-dd"}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
          <div class="content-label">
            <label class="details-label">Date Fin</label>
            <label *ngIf="transaction" class="details-label">{{transaction?.end_date | date:"yyyy-MM-dd"}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
        </base-card-body>
      </base-card>
      <!--            </div>-->

      <div class="element-2">
        <button style="margin-right: 5px;"
          class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Intégrer
          transaction
        </button>
        <button (click)='correctionAllFile();$event.stopPropagation();'
          class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
        </button>
      </div>

    </div>

    <div class="content-labels">

      <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
        <base-card-title class="reorder">
          <div>
            <label>Fichier de livraison </label>
          </div>
          <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
            <div class="mdl-textfield label-search">
              <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsLivraison()"
                [(ngModel)]="filterValueLivraison" placeholder="Rechercher" autocomplete="off" />
              <label class="mdl-textfield__label" for="search2"></label>
            </div>
          </div>
        </base-card-title>
        <base-card-body class="content-file-line">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Afficher Log
                </mat-panel-title>
                <mat-panel-description class="description">
                  <button (click)='correctionFile("livraison");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button>
                  <button (click)='resetFiltre("livraison");$event.stopPropagation();' style="margin-left: 5px;"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                    les filtres
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                [show]="showLoaderLivraisonFile"></app-loader>
              <div class="content-table">
                <div class="pagination">
                  <mat-paginator [hidden]="!dataSource.data.length" [pageSizeOptions] = "[100,200,300]" showFirstLastButtons></mat-paginator>
                </div>
                <table  mat-table [dataSource]="dataSource" *ngIf = "dataSource.data.length > 0"
                  class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">

                  <!-- Tournee Column -->
                  <ng-container matColumnDef="Tournee">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Tournee

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index" 

                    >
                      {{element.Tournee}} </td>
                  </ng-container>

                  <!-- taskId Column -->
                  <ng-container matColumnDef="taskId">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> taskId

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"

                    >
                      {{element.taskId}} </td>
                  </ng-container>

                  <!-- itemId Column -->
                  <ng-container matColumnDef="itemId">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> itemId

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"

                    >
                      {{element.itemId}} </td>
                  </ng-container>

                  <!-- Date Column -->
                  <ng-container matColumnDef="Date">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Date

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index" (mousedown)="onMouseDown(i, 0, 'Date')"
                      (mouseup)="onMouseUp(i, 0, 'Date','livraison')"
                    >
                      {{element.Date}} </td>
                  </ng-container>

                  <!-- Expediteur Column -->
                  <ng-container matColumnDef="Expediteur">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Expediteur

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index" (mousedown)="onMouseDown(i, 1, 'Expediteur')"
                      (mouseup)="onMouseUp(i, 1, 'Expediteur','livraison')">
                      {{element.Expediteur}} </td>
                  </ng-container>

                  <!-- Activite Column -->
                  <ng-container matColumnDef="Activite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Activite
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 2, 'Activite')"
                      (mouseup)="onMouseUp(i, 2, 'Activite','livraison')">
                      {{element.Activite}} </td>
                  </ng-container>

                  <!-- Categorie Column -->
                  <ng-container matColumnDef="Categorie">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Categorie
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 3, 'Categorie')"
                      (mouseup)="onMouseUp(i, 3, 'Categorie','livraison')"
                    >
                      {{element.Categorie}} </td>
                  </ng-container>

                  <!-- Type_de_Service Column -->
                  <ng-container matColumnDef="Type_de_Service">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Type_de_Service
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 4, 'Type_de_Service')"
                      (mouseup)="onMouseUp(i, 4, 'Type_de_Service','livraison')"
                    >
                      {{element.Type_de_Service}} </td>
                  </ng-container>

                  <!-- ID_de_la_tache Column -->
                  <ng-container matColumnDef="ID_de_la_tache">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> ID_de_la_tache

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 5, 'ID_de_la_tache')"
                      (mouseup)="onMouseUp(i, 5, 'ID_de_la_tache','livraison')"
                    >
                      {{element.ID_de_la_tache}} </td>
                  </ng-container>

                  <!-- Item___Nom_sous_categorie Column -->
                  <ng-container matColumnDef="Item___Nom_sous_categorie">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Nom_sous_categorie
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 6, 'Item___Nom_sous_categorie')"
                      (mouseup)="onMouseUp(i, 6, 'Item___Nom_sous_categorie','livraison')"
                    >
                      {{element.Item___Nom_sous_categorie}} </td>
                  </ng-container>

                  <!-- Item___Type_unite_manutention Column -->
                  <ng-container matColumnDef="Item___Type_unite_manutention">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Type_unite_manutention
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 7, 'Item___Type_unite_manutention')"
                      (mouseup)="onMouseUp(i, 7, 'Item___Type_unite_manutention','livraison')"
                    >
                      {{element.Item___Type_unite_manutention}} </td>
                  </ng-container>

                  <!-- Item___Quantite Column -->
                  <ng-container matColumnDef="Item___Quantite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Quantite
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 8, 'Item___Quantite')"
                      (mouseup)="onMouseUp(i, 8, 'Item___Quantite','livraison')"
                    >
                      {{element.Item___Quantite}} </td>
                  </ng-container>

                  <!-- Code_postal Column -->
                  <ng-container matColumnDef="Code_postal">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Code_postal
         
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 9, 'Code_postal')"
                      (mouseup)="onMouseUp(i, 9, 'Code_postal','livraison')"
                    >
                      {{element.Code_postal}} </td>
                  </ng-container>

                  <!-- sourceHubName Column -->
                  <ng-container matColumnDef="sourceHubName">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> sourceHubName
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 10, 'sourceHubName')"
                      (mouseup)="onMouseUp(i, 10, 'sourceHubName','livraison')"
                    >
                      {{element.sourceHubName}} </td>
                  </ng-container>

                  <!-- Round_Name Column -->
                  <ng-container matColumnDef="Round_Name">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Round_Name
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 11, 'Round_Name')"
                      (mouseup)="onMouseUp(i, 11, 'Round_Name','livraison')"
                    >
                      {{element.Round_Name}} </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumnsLivraison; sticky: true"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsLivraison;"></tr>
                </table>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </base-card-body>
      </base-card>


    </div>
    <div class="content-labels">

      <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
        <base-card-title class="reorder">
          <div>
            <label>Fichier d'exception </label>
          </div>
          <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
            <div class="mdl-textfield label-search">
              <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsException()"
                [(ngModel)]="filterValueException" placeholder="Rechercher" autocomplete="off" />
              <label class="mdl-textfield__label" for="search2"></label>
            </div>
          </div>
        </base-card-title>
        <base-card-body class="content-file-line">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Afficher Log
                </mat-panel-title>
                <mat-panel-description class="description">
                  <button (click)='correctionFile("exception");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button>
                  <button (click)='resetFiltre("exception");$event.stopPropagation();' style="margin-left: 5px;"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                    les filtres
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                [show]="showLoaderExceptionFile"></app-loader>
              <div class="content-table">
                <div class="pagination">
                  <mat-paginator [hidden]="!dataSourceException.data.length" [pageSizeOptions] = "[100,200,300]" showFirstLastButtons></mat-paginator>
                </div>
                <table mat-table [dataSource]="dataSourceException" *ngIf = "dataSourceException.data.length > 0"
                  class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">

                  <!-- Tournee Column -->
                  <ng-container matColumnDef="Tournee">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Tournee

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index" 

                    >
                      {{element.Tournee}} </td>
                  </ng-container>

                  <!-- taskId Column -->
                  <ng-container matColumnDef="taskId">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> taskId

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"

                    >
                      {{element.taskId}} </td>
                  </ng-container>

                  <!-- itemId Column -->
                  <ng-container matColumnDef="itemId">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> itemId

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"

                    >
                      {{element.itemId}} </td>
                  </ng-container>

                  <!-- Date Column -->
                  <ng-container matColumnDef="Date">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Date

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Date}} </td>
                  </ng-container>

                  <!-- Expediteur Column -->
                  <ng-container matColumnDef="Expediteur">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Expediteur
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Expediteur}} </td>
                  </ng-container>

                  <!-- Activite Column -->
                  <ng-container matColumnDef="Activite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Activite
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Activite}} </td>
                  </ng-container>

                  <!-- Categorie Column -->
                  <ng-container matColumnDef="Categorie">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Categorie
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Categorie}} </td>
                  </ng-container>

                  <!-- Type_de_Service Column -->
                  <ng-container matColumnDef="Type_de_Service">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Type_de_Service
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Type_de_Service}} </td>
                  </ng-container>

                  <!-- ID_de_la_tache Column -->
                  <ng-container matColumnDef="ID_de_la_tache">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> ID_de_la_tache
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.ID_de_la_tache}} </td>
                  </ng-container>

                  <!-- Item___Nom Column -->
                  <ng-container matColumnDef="Item___Nom">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Nom
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Item___Nom}} </td>
                  </ng-container>

                  <!-- Item___Type Column -->
                  <ng-container matColumnDef="Item___Type">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Type
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Item___Type}} </td>
                  </ng-container>

                  <!-- Item___Quantite Column -->
                  <ng-container matColumnDef="Item___Quantite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Quantite
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Item___Quantite}} </td>
                  </ng-container>

                  <!-- Code_postal Column -->
                  <ng-container matColumnDef="Code_postal">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Code_postal
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Code_postal}} </td>
                  </ng-container>

                  <!-- Round_Name Column -->
                  <ng-container matColumnDef="Round_Name">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Round_Name
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Round_Name}} </td>
                  </ng-container>

                  <!-- Remarque Column -->
                  <ng-container matColumnDef="Remarque">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Remarque
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Remarque}} </td>
                  </ng-container>

                  <!-- isDeleted Column -->
                  <ng-container matColumnDef="isDeleted">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> isDeleted
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.isDeleted}} </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumnsException; sticky: true"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsException;"></tr>
                </table>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </base-card-body>
      </base-card>


    </div>
    <div class="content-labels">

      <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
        <base-card-title class="reorder">
          <div>
            <label>Fichier Metadata </label>
          </div>
          <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
            <div class="mdl-textfield label-search">
              <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsMetadata()"
                [(ngModel)]="filterValuemetadata" placeholder="Rechercher" autocomplete="off" />
              <label class="mdl-textfield__label" for="search2"></label>
            </div>
          </div>
        </base-card-title>
        <base-card-body class="content-file-line">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Afficher Log
                </mat-panel-title>
                <mat-panel-description class="description">
                  <button (click)='correctionFile("metadata");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Valider
                  </button>
                  <button (click)='resetFiltre("metadata");$event.stopPropagation();' style="margin-left: 5px;"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                    les filtres
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                [show]="showLoaderMetadataFile"></app-loader>
              <div class="content-table">
                <div class="pagination">
                  <mat-paginator [hidden]="!dataSourceMetaData.data.length" [pageSizeOptions] = "[100,200,300]" showFirstLastButtons></mat-paginator>
                </div>
                <table mat-table [dataSource]="dataSourceMetaData" *ngIf = "dataSourceMetaData.data.length > 0"
                  class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">
                  <!-- Tournee Column -->
                  <ng-container matColumnDef="Tournee">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Tournee

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index" 

                    >
                      {{element.Tournee}} </td>
                  </ng-container>

                  <!-- taskId Column -->
                  <ng-container matColumnDef="taskId">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> taskId

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"

                    >
                      {{element.taskId}} </td>
                  </ng-container>

                  <!-- itemId Column -->
                  <ng-container matColumnDef="itemId">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> itemId

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"

                    >
                      {{element.itemId}} </td>
                  </ng-container>

                  <!-- Date Column -->
                  <ng-container matColumnDef="Date">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Date
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Date}} </td>
                  </ng-container>

                  <!-- Expediteur Column -->
                  <ng-container matColumnDef="Expediteur">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Expediteur
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Expediteur}} </td>
                  </ng-container>

                  <!-- Activite Column -->
                  <ng-container matColumnDef="Activite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Activite
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Activite}} </td>
                  </ng-container>

                  <!-- Categorie Column -->
                  <ng-container matColumnDef="Categorie">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Categorie
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Categorie}} </td>
                  </ng-container>

                  <!-- Type_de_Service Column -->
                  <ng-container matColumnDef="Type_de_Service">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Type_de_Service
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Type_de_Service}} </td>
                  </ng-container>

                  <!-- ID_de_la_tache Column -->
                  <ng-container matColumnDef="ID_de_la_tache">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> ID_de_la_tache

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.ID_de_la_tache}} </td>
                  </ng-container>

                  <!-- Item___Nom_sous_categorie Column -->
                  <ng-container matColumnDef="Item___Nom_sous_categorie">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Nom_sous_categorie

                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Item___Nom_sous_categorie}} </td>
                  </ng-container>

                  <!-- Item___Type_unite_manutention Column -->
                  <ng-container matColumnDef="Item___Type_unite_manutention">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Type_unite_manutention
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Item___Type_unite_manutention}} </td>
                  </ng-container>

                  <!-- Item___Quantite Column -->
                  <ng-container matColumnDef="Item___Quantite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Quantite
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Item___Quantite}} </td>
                  </ng-container>

                  <!-- Code_postal Column -->
                  <ng-container matColumnDef="Code_postal">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Code_postal
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Code_postal}} </td>
                  </ng-container>

                  <!-- sourceHubName Column -->
                  <ng-container matColumnDef="sourceHubName">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> sourceHubName
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.sourceHubName}} </td>
                  </ng-container>

                  <!-- Round_Name Column -->
                  <ng-container matColumnDef="Round_Name">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Round_Name
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.Round_Name}} </td>
                  </ng-container>

                  <!-- sourceClosureDate Column -->
                  <ng-container matColumnDef="sourceClosureDate">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> sourceClosureDate
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.sourceClosureDate}} </td>
                  </ng-container>

                  <!-- realInfoHasPrepared Column -->
                  <ng-container matColumnDef="realInfoHasPrepared">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> realInfoHasPrepared
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.realInfoHasPrepared}} </td>
                  </ng-container>

                  <!-- status Column -->
                  <ng-container matColumnDef="status">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> status
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.status}} </td>
                  </ng-container>

                  <!-- metadataFACTURATION Column -->
                  <ng-container matColumnDef="metadataFACTURATION">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> metadataFACTURATION
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                      {{element.metadataFACTURATION}} </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumnsMetadata; sticky: true"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsMetadata;"></tr>
                </table>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </base-card-body>
      </base-card>


    </div>
    <div class="content-labels">

      <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
        <base-card-title class="reorder">
          <div>
            <label>Fichier MAD </label>
          </div>
          <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
            <div class="mdl-textfield label-search">
              <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsMAD()"
                [(ngModel)]="filterValueMad" placeholder="Rechercher" autocomplete="off" />
              <label class="mdl-textfield__label" for="search2"></label>
            </div>
          </div>
        </base-card-title>
        <base-card-body class="content-file-line">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Afficher Log
                </mat-panel-title>
                <mat-panel-description class="description">
                  <button (click)='correctionFile("mad");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button>
                  <button (click)='resetFiltre("mad");$event.stopPropagation();' style="margin-left: 5px;"
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                    les filtres
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                [show]="showLoaderMadFile"></app-loader>
              <div *ngIf="fichierMad !==null && fichierMad.length>0" class="content-table">
                <table mat-table [dataSource]="fichierMad"
                  class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">

                  <!-- Date Column -->
                  <ng-container matColumnDef="Date">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Date
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[0].columnProp}}"
                          [(ngModel)]="optionsMad[0].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[0],$event)">
                          <mat-option value="">-- Select {{optionsMad[0].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[0].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 0, 'Date')"
                      (mouseup)="onMouseUp(i, 0, 'Date','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][0], 'unselected': !selectedCellsStateMad[i][0]}">
                      {{element.Date}} </td>
                  </ng-container>

                  <!-- Expediteur Column -->
                  <ng-container matColumnDef="Expediteur">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Expediteur
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[1].columnProp}}"
                          [(ngModel)]="optionsMad[1].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[1],$event)">
                          <mat-option value="">-- Select {{optionsMad[1].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[1].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 1, 'Expediteur')"
                      (mouseup)="onMouseUp(i, 1, 'Expediteur','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][1], 'unselected': !selectedCellsStateMad[i][1]}">
                      {{element.Expediteur}} </td>
                  </ng-container>

                  <!-- Activite Column -->
                  <ng-container matColumnDef="Activite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Activite
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[2].columnProp}}"
                          [(ngModel)]="optionsMad[2].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[2],$event)">
                          <mat-option value="">-- Select {{optionsMad[2].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[2].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 2, 'Activite')"
                      (mouseup)="onMouseUp(i, 2, 'Activite','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][2], 'unselected': !selectedCellsStateMad[i][2]}">
                      {{element.Activite}} </td>
                  </ng-container>

                  <!-- Categorie Column -->
                  <ng-container matColumnDef="Categorie">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Categorie
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[3].columnProp}}"
                          [(ngModel)]="optionsMad[3].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[3],$event)">
                          <mat-option value="">-- Select {{optionsMad[3].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[3].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 3, 'Categorie')"
                      (mouseup)="onMouseUp(i, 3, 'Categorie','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][3], 'unselected': !selectedCellsStateMad[i][3]}">
                      {{element.Categorie}} </td>
                  </ng-container>

                  <!-- Type_de_Service Column -->
                  <ng-container matColumnDef="Type_de_Service">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Type_de_Service
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[4].columnProp}}"
                          [(ngModel)]="optionsMad[4].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[4],$event)">
                          <mat-option value="">-- Select {{optionsMad[4].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[4].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 4, 'Type_de_Service')"
                      (mouseup)="onMouseUp(i, 4, 'Type_de_Service','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][4], 'unselected': !selectedCellsStateMad[i][4]}">
                      {{element.Type_de_Service}} </td>
                  </ng-container>

                  <!-- ID_de_la_tache Column -->
                  <ng-container matColumnDef="ID_de_la_tache">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> ID_de_la_tache
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[5].columnProp}}"
                          [(ngModel)]="optionsMad[5].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[5],$event)">
                          <mat-option value="">-- Select {{optionsMad[5].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[5].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 5, 'ID_de_la_tache')"
                      (mouseup)="onMouseUp(i, 5, 'ID_de_la_tache','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][5], 'unselected': !selectedCellsStateMad[i][5]}">
                      {{element.ID_de_la_tache}} </td>
                  </ng-container>

                  <!-- Item___Nom_sous_categorie Column -->
                  <ng-container matColumnDef="Item___Nom_sous_categorie">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Nom_sous_categorie
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[6].columnProp}}"
                          [(ngModel)]="optionsMad[6].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[6],$event)">
                          <mat-option value="">-- Select {{optionsMad[6].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[6].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 6, 'Item___Nom_sous_categorie')"
                      (mouseup)="onMouseUp(i, 6, 'Item___Nom_sous_categorie','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][6], 'unselected': !selectedCellsStateMad[i][6]}">
                      {{element.Item___Nom_sous_categorie}} </td>
                  </ng-container>

                  <!-- Item___Type_unite_manutention Column -->
                  <ng-container matColumnDef="Item___Type_unite_manutention">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Type_unite_manutention
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[7].columnProp}}"
                          [(ngModel)]="optionsMad[7].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[7],$event)">
                          <mat-option value="">-- Select {{optionsMad[7].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[7].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 7, 'Item___Type_unite_manutention')"
                      (mouseup)="onMouseUp(i, 7, 'Item___Type_unite_manutention','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][7], 'unselected': !selectedCellsStateMad[i][7]}">
                      {{element.Item___Type_unite_manutention}} </td>
                  </ng-container>

                  <!-- Item___Quantite Column -->
                  <ng-container matColumnDef="Item___Quantite">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Item___Quantite
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[8].columnProp}}"
                          [(ngModel)]="optionsMad[8].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[8],$event)">
                          <mat-option value="">-- Select {{optionsMad[8].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[8].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 8, 'Item___Quantite')"
                      (mouseup)="onMouseUp(i, 8, 'Item___Quantite','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][8], 'unselected': !selectedCellsStateMad[i][8]}">
                      {{element.Item___Quantite}} </td>
                  </ng-container>

                  <!-- Code_postal Column -->
                  <ng-container matColumnDef="Code_postal">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Code_postal
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[9].columnProp}}"
                          [(ngModel)]="optionsMad[9].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[9],$event)">
                          <mat-option value="">-- Select {{optionsMad[9].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[9].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 9, 'Code_postal')" (mouseup)="onMouseUp(i, 9, 'Code_postal','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][9], 'unselected': !selectedCellsStateMad[i][9]}">
                      {{element.Code_postal}} </td>
                  </ng-container>

                  <!-- sourceHubName Column -->
                  <ng-container matColumnDef="sourceHubName">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> sourceHubName
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[10].columnProp}}"
                          [(ngModel)]="optionsMad[10].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[10],$event)">
                          <mat-option value="">-- Select {{optionsMad[10].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[10].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 10, 'sourceHubName')"
                      (mouseup)="onMouseUp(i, 10, 'sourceHubName','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][10], 'unselected': !selectedCellsStateMad[i][10]}">
                      {{element.sourceHubName}} </td>
                  </ng-container>

                  <!-- Round_Name Column -->
                  <ng-container matColumnDef="Round_Name">
                    <th class="titre-column" mat-header-cell *matHeaderCellDef> Round_Name
                      <mat-form-field class="form-column" appearance="fill">
                        <mat-select class="filter-column" matNativeControl name="{{optionsMad[11].columnProp}}"
                          [(ngModel)]="optionsMad[11].modelValue"
                          (selectionChange)="setFilteredItemsMadOptions(optionsMad[11],$event)">
                          <mat-option value="">-- Select {{optionsMad[11].columnProp}}--</mat-option>
                          <mat-option [value]="item" *ngFor="let item of optionsMad[11].options"><label>{{item}}</label>
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </th>
                    <td mat-cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                      (mousedown)="onMouseDown(i, 11, 'Round_Name')" (mouseup)="onMouseUp(i, 11, 'Round_Name','mad')"
                      [ngClass]="{'selected': selectedCellsStateMad[i][11], 'unselected': !selectedCellsStateMad[i][11]}">
                      {{element.Round_Name}} </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumnsMad; sticky: true"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsMad;"></tr>
                </table>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </base-card-body>
      </base-card>


    </div>
  </div>
</div>