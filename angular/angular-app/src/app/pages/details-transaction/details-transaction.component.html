<div class="container-transaction mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
  <div class="content-file-edi">
    <!-- <div style="text-align: left;padding-left: inherit;"
      class="mdl-cell mdl-cell--5-col-desktop mdl-cell--5-col-tablet mdl-cell--2-col-phone">
      <label class="number-transaction ">Transaction {{transaction?.transaction_id}}</label>
    </div> -->
    <div class="content-labels" id="conteneur-transaction">
      <!--            <div class="element 1">-->
      <base-card class="element-1"
        class="mdl-cell mdl-cell--8-col-desktop mdl-cell--8-col-tablet mdl-cell--3-col-phone">
        <base-card-body class="content-card">
          <div class="content-label">
            <label class="details-label">Statut</label>
            <label *ngIf="transaction" class="details-label">{{transaction?.statut}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
          <div class="content-label">
            <label class="details-label">Date Création </label>
            <label *ngIf="transaction" class="details-label">{{transaction?.created_at | date:"dd-MM-yyyy 'à'
              HH:mm"}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
          <div class="content-label">
            <label class="details-label">Dernière modification </label>
            <label *ngIf="transaction" class="details-label">{{transaction?.modified_at | date:"dd-MM-yyyy 'à'
              HH:mm"}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
          <div class="content-label">
            <label class="details-label">Date Début </label>
            <label *ngIf="transaction" class="details-label">{{transaction?.start_date | date:"dd-MM-yyyy"}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
          <div class="content-label">
            <label class="details-label">Date Fin</label>
            <label *ngIf="transaction" class="details-label">{{transaction?.end_date | date:"dd-MM-yyyy"}}</label>
            <label *ngIf="!transaction" class="details-label">-</label>
          </div>
        </base-card-body>
      </base-card>
      <!--            </div>-->

      <div class="element-2">

        <button style="margin-right: 5px;" [disabled]="true"
          class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Intégrer
          transaction
        </button>
        <button (click)='correctionAllFile();$event.stopPropagation();' [disabled]="showLoader"
          class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
        </button>
      </div>

    </div>
    <app-loader [width]="'100%'" [position]="'sticky'" [height]="'450px'" [bg]="'transparant'" [show]="showLoader">
    </app-loader>
    <div *ngIf="!showLoader">
      <div class="content-labels">

        <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
          <base-card-title class="reorder">
            <div>
              <label>Fichier de livraison </label>
            </div>
            <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
              <div class="mdl-textfield label-search">
                <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsLivraison()"
                  [(ngModel)]="filterValueLivraison" placeholder="Rechercher" autocomplete="off" />
                <label class="mdl-textfield__label" for="search2"></label>
              </div>
            </div>
          </base-card-title>
          <base-card-body class="content-file-line">
            <mat-accordion>
              <mat-expansion-panel hideToggle>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Afficher Log
                  </mat-panel-title>
                  <mat-panel-description class="description">
                    <!-- <button (click)='deleteRowsLivraison();$event.stopPropagation();' id="deleteWrongBtn"
                    [disabled]=" rowsToDeleteLivraison?.length==0 || alreadyClicked==true" style="margin-right: 5px;"
                    class=" delete-button mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal">Effacer
                  </button>
                  <button (click)='correctionFile("livraison");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button> -->
                    <button (click)='resetFiltre("livraison");$event.stopPropagation();' style="margin-right: 7px;"
                      class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                      les filtres
                    </button>
                    <button (click)='openSelectClientDialog("livraison");$event.stopPropagation();'
                      class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">
                      <span class="material-icons btndownload">
                        download
                      </span>
                    </button>
                  </mat-panel-description>
                </mat-expansion-panel-header>
                <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                  [show]="showLoaderLivraisonFile"></app-loader>
                <div class="content-table">

                  <mat-paginator [hidden]="!dataSource.data.length" [pageSizeOptions]="[100,200,300]"
                    showFirstLastButtons></mat-paginator>

                  <table mat-table [dataSource]="dataSource" *ngIf="dataSource.data.length > 0"
                    class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">

                    <!-- Date Column -->
                    <ng-container matColumnDef="Date">
                      <th id="Date" class="titre-column" mat-header-cell *matHeaderCellDef> Date
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[1].columnProp}}"
                            [(ngModel)]="options[1].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[1],$event)">
                            <mat-option value="">-- Select {{options[1].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[1].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"
                        (mousedown)="onMouseDown(i, 1, 'Date','livraison')"
                        (mouseup)="onMouseUp(i, 1, 'Date','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][1], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][1]}">
                        {{element.Date}} </td>
                    </ng-container>

                    <!-- Expediteur Column -->
                    <ng-container matColumnDef="Expediteur">

                      <th id="Expediteur" class="titre-column" mat-header-cell *matHeaderCellDef> Expediteur
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[2].columnProp}}"
                            [(ngModel)]="options[2].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[2],$event)">
                            <mat-option value="">-- Select {{options[2].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[2].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element; let i = index"
                        (mousedown)="onMouseDown(i, 2, 'Expediteur','livraison')"
                        (mouseup)="onMouseUp(i, 2, 'Expediteur','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][2], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][2]}">
                        {{element.Expediteur}} </td>
                    </ng-container>

                    <!-- Activite Column -->
                    <ng-container matColumnDef="Activite">
                      <th id="Activite" class="titre-column" mat-header-cell *matHeaderCellDef> Activite
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[3].columnProp}}"
                            [(ngModel)]="options[3].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[3],$event)">
                            <mat-option value="">-- Select {{options[3].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[3].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 3, 'Activite','livraison')"
                        (mouseup)="onMouseUp(i, 3, 'Activite','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][3], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][3]}">
                        {{element.Activite}} </td>
                    </ng-container>

                    <!-- Categorie Column -->
                    <ng-container matColumnDef="Categorie">
                      <th id="Categorie" class="titre-column" mat-header-cell *matHeaderCellDef> Categorie
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[4].columnProp}}"
                            [(ngModel)]="options[4].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[4],$event)">
                            <mat-option value="">-- Select {{options[4].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[4].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 4, 'Categorie','livraison')"
                        (mouseup)="onMouseUp(i, 4, 'Categorie','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][4], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][4]}">
                        {{element.Categorie}} </td>
                    </ng-container>

                    <!-- Type_de_Service Column -->
                    <ng-container matColumnDef="Type_de_Service">
                      <th id="Type_de_Service" class="titre-column" mat-header-cell *matHeaderCellDef> Type_de_Service
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[5].columnProp}}"
                            [(ngModel)]="options[5].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[5],$event)">
                            <mat-option value="">-- Select {{options[5].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[5].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 5, 'Type_de_Service','livraison')"
                        (mouseup)="onMouseUp(i, 5, 'Type_de_Service','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][5], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][5]}">
                        {{element.Type_de_Service}} </td>
                    </ng-container>

                    <!-- ID_de_la_tache Column -->
                    <ng-container matColumnDef="ID_de_la_tache">
                      <th id="ID_de_la_tache" class="titre-column" mat-header-cell *matHeaderCellDef> ID_de_la_tache
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[6].columnProp}}"
                            [(ngModel)]="options[6].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[6],$event)">
                            <mat-option value="">-- Select {{options[6].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[6].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 6, 'ID_de_la_tache','livraison')"
                        (mouseup)="onMouseUp(i, 6, 'ID_de_la_tache','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][6], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][6]}">
                        {{element.ID_de_la_tache}} </td>
                    </ng-container>

                    <!-- Item___Nom_sous_categorie Column -->
                    <ng-container matColumnDef="Item___Nom_sous_categorie">
                      <th id="Item___Nom_sous_categorie" class="titre-column" mat-header-cell *matHeaderCellDef>
                        Item___Nom_sous_categorie
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[7].columnProp}}"
                            [(ngModel)]="options[7].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[7],$event)">
                            <mat-option value="">-- Select {{options[7].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[7].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 7, 'Item___Nom_sous_categorie','livraison')"
                        (mouseup)="onMouseUp(i, 7, 'Item___Nom_sous_categorie','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][7], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][7]}">
                        {{element.Item___Nom_sous_categorie}} </td>
                    </ng-container>

                    <!-- Item___Type_unite_manutention Column -->
                    <ng-container matColumnDef="Item___Type_unite_manutention">
                      <th id="Item___Type_unite_manutention" class="titre-column" mat-header-cell *matHeaderCellDef>
                        Item___Type_unite_manutention
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[8].columnProp}}"
                            [(ngModel)]="options[8].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[8],$event)">
                            <mat-option value="">-- Select {{options[8].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[8].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 8, 'Item___Type_unite_manutention','livraison')"
                        (mouseup)="onMouseUp(i, 8, 'Item___Type_unite_manutention','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][8], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][8]}">
                        {{element.Item___Type_unite_manutention}} </td>
                    </ng-container>

                    <!-- Item___Quantite Column -->
                    <ng-container matColumnDef="Item___Quantite">
                      <th id="Item___Quantite" class="titre-column" mat-header-cell *matHeaderCellDef> Item___Quantite
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[9].columnProp}}"
                            [(ngModel)]="options[9].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[9],$event)">
                            <mat-option value="">-- Select {{options[9].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[9].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 9, 'Item___Quantite','livraison')"
                        (mouseup)="onMouseUp(i, 9, 'Item___Quantite','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][9], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][9]}">
                        {{element.Item___Quantite}} </td>
                    </ng-container>

                    <!-- Code_postal Column -->
                    <ng-container matColumnDef="Code_postal">
                      <th id="Code_postal" class="titre-column" mat-header-cell *matHeaderCellDef> Code_postal
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[10].columnProp}}"
                            [(ngModel)]="options[10].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[10],$event)">
                            <mat-option value="">-- Select {{options[10].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[10].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 10, 'Code_postal','livraison')"
                        (mouseup)="onMouseUp(i, 10, 'Code_postal','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][10], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][10]}">
                        {{element.Code_postal}} </td>
                    </ng-container>

                    <!-- sourceHubName Column -->
                    <ng-container matColumnDef="sourceHubName">
                      <th id="sourceHubName" class="titre-column" mat-header-cell *matHeaderCellDef> sourceHubName
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[11].columnProp}}"
                            [(ngModel)]="options[11].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[11],$event)">
                            <mat-option value="">-- Select {{options[11].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[11].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 11, 'sourceHubName','livraison')"
                        (mouseup)="onMouseUp(i, 11, 'sourceHubName','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][11], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][11]}">
                        {{element.sourceHubName}} </td>
                    </ng-container>

                    <!-- Round_Name Column -->
                    <ng-container matColumnDef="Round_Name">
                      <th id="Round_Name" class="titre-column" mat-header-cell *matHeaderCellDef> Round_Name
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[12].columnProp}}"
                            [(ngModel)]="options[12].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[12],$event)">
                            <mat-option value="">-- Select {{options[12].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[12].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 12, 'Round_Name','livraison')"
                        (mouseup)="onMouseUp(i, 12, 'Round_Name','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][12], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][12]}">
                        {{element.Round_Name}} </td>
                    </ng-container>

                    <!-- isExpress Column -->
                    <ng-container matColumnDef="isExpress">
                      <th id="isExpress" class="titre-column" mat-header-cell *matHeaderCellDef> isExpress
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[13].columnProp}}"
                            [(ngModel)]="options[13].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[13],$event)">
                            <mat-option value="">-- Select {{options[13].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[13].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 13, 'isExpress','livraison')"
                        (mouseup)="onMouseUp(i, 13, 'isExpress','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][13], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][13]}">
                        {{element.isExpress}} </td>
                    </ng-container>


                    <!-- total_price Column -->
                    <ng-container matColumnDef="total_price">
                      <th id="total_price" class="titre-column" mat-header-cell *matHeaderCellDef> total_price
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[14].columnProp}}"
                            [(ngModel)]="options[14].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[14],$event)">
                            <mat-option value="">-- Select {{options[14].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[14].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 14, 'isExpress','livraison')"
                        (mouseup)="onMouseUp(i, 14, 'isExpress','livraison')"
                        [ngClass]="{'selected': selectedCellsState[i+ paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][14], 'unselected': !selectedCellsState[i+paginator.toArray()[0].pageIndex*paginator.toArray()[0].pageSize][14]}">
                        {{element.total_price}} </td>
                    </ng-container>

                    <!-- billingRoundName Column -->
                    <ng-container matColumnDef="billingRoundName">
                      <th id="billingRoundName" class="titre-column" mat-header-cell *matHeaderCellDef> billingRoundName
                        <mat-form-field class="form-column" appearance="fill" *ngIf="options">
                          <mat-select class="filter-column" matNativeControl name="{{options[15].columnProp}}"
                            [(ngModel)]="options[15].modelValue"
                            (selectionChange)="setFilteredItemsOptions(options[15],$event)">
                            <mat-option value="">-- Select {{options[15].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of options[15].options"><label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles" *matCellDef="let element ; let i = index">
                        {{element.billingRoundName}} </td>
                    </ng-container>




                    <ng-container matColumnDef="toDelete">
                      <th id="isDeletedLivraison" style="padding-bottom: 16px;" class="titre-column-livraison"
                        mat-header-cell *matHeaderCellDef>
                        toDelete
                        <mat-checkbox style="margin-left:5px"
                          (change)="$event ? deleteMasterToggleLivraison($event) : null"
                          [checked]=" allLivraison==true">
                        </mat-checkbox>
                      </th>
                      <td mat-cell #cell class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index">
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          [checked]=" isRowLivraisonSelected(element.taskId)"
                          (change)="selectDeleteRow(element,'livraison')">
                        </mat-checkbox>
                      </td>

                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumnsLivraison; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsLivraison;"></tr>
                  </table>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </base-card-body>
        </base-card>


      </div>
      <div class="content-labels">

        <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
          <base-card-title class="reorder">
            <div>
              <label>Fichier d'exception </label>
            </div>
            <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
              <div class="mdl-textfield label-search">
                <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsException()"
                  [(ngModel)]="filterValueException" placeholder="Rechercher" autocomplete="off" />
                <label class="mdl-textfield__label" for="search2"></label>
              </div>
            </div>
          </base-card-title>
          <base-card-body class="content-file-line">
            <mat-accordion>
              <mat-expansion-panel hideToggle>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Afficher Log
                  </mat-panel-title>
                  <mat-panel-description class="description">
                    <!-- <button (click)='deleteRowsException();$event.stopPropagation();' id="deleteWrongBtn"
                    [disabled]=" rowsToDeleteException?.length==0 || alreadyClicked==true" style="margin-right: 5px;"
                    class=" delete-button mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal">Effacer
                  </button>
                  <button (click)='correctionFile("exception");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button> -->
                    <button (click)='resetFiltre("exception");$event.stopPropagation();' style="margin-left: 5px;"
                      class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                      les filtres
                    </button>
                  </mat-panel-description>
                </mat-expansion-panel-header>
                <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                  [show]="showLoaderExceptionFile"></app-loader>
                <div class="content-table">
                  <div>
                    <mat-paginator [hidden]="!dataSourceException.data.length" [pageSizeOptions]="[100,200,300]"
                      showFirstLastButtons></mat-paginator>
                  </div>
                  <table mat-table [dataSource]="dataSourceException" *ngIf="dataSourceException.data.length > 0"
                    class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">




                    <!-- Date Column -->
                    <ng-container matColumnDef="Date">
                      <th id="DateException" class="titre-column-exception" mat-header-cell *matHeaderCellDef> Date
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[1].columnProp}}"
                            [(ngModel)]="optionsException[1].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[1],$event)">
                            <mat-option value="">-- Select {{optionsException[1].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[1].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 1, 'Date','exception')"
                        (mouseup)="onMouseUp(i, 1, 'Date','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][1], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][1]}">
                        {{element.Date}} </td>
                    </ng-container>

                    <!-- Expediteur Column -->
                    <ng-container matColumnDef="Expediteur">
                      <th id="ExpediteurException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Expediteur
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[2].columnProp}}"
                            [(ngModel)]="optionsException[2].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[2],$event)">
                            <mat-option value="">-- Select {{optionsException[2].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[2].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 2, 'Expediteur','exception')"
                        (mouseup)="onMouseUp(i, 2, 'Expediteur','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][2], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][2]}">
                        {{element.Expediteur}} </td>
                    </ng-container>

                    <!-- Activite Column -->
                    <ng-container matColumnDef="Activite">
                      <th id="ActiviteException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Activite
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[3].columnProp}}"
                            [(ngModel)]="optionsException[3].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[3],$event)">
                            <mat-option value="">-- Select {{optionsException[3].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[3].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 3, 'Activite','exception')"
                        (mouseup)="onMouseUp(i, 3, 'Activite','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][3], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][3]}">
                        {{element.Activite}} </td>
                    </ng-container>

                    <!-- Categorie Column -->
                    <ng-container matColumnDef="Categorie">
                      <th id="CategorieException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Categorie
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[4].columnProp}}"
                            [(ngModel)]="optionsException[4].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[4],$event)">
                            <mat-option value="">-- Select {{optionsException[4].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[4].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 4, 'Categorie','exception')"
                        (mouseup)="onMouseUp(i, 4, 'Categorie','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][4], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][4]}">
                        {{element.Categorie}} </td>
                    </ng-container>

                    <!-- Type_de_Service Column -->
                    <ng-container matColumnDef="Type_de_Service">
                      <th id="Type_de_ServiceException" class="titre-column-exception" mat-header-cell
                        *matHeaderCellDef>
                        Type_de_Service
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[5].columnProp}}"
                            [(ngModel)]="optionsException[5].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[5],$event)">
                            <mat-option value="">-- Select {{optionsException[5].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[5].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 5, 'Type_de_Service','exception')"
                        (mouseup)="onMouseUp(i, 5, 'Type_de_Service','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][5], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][5]}">
                        {{element.Type_de_Service}} </td>
                    </ng-container>

                    <!-- ID_de_la_tache Column -->
                    <ng-container matColumnDef="ID_de_la_tache">
                      <th id="ID_de_la_tacheException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        ID_de_la_tache
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[6].columnProp}}"
                            [(ngModel)]="optionsException[6].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[6],$event)">
                            <mat-option value="">-- Select {{optionsException[6].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[6].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 6, 'ID_de_la_tache','exception')"
                        (mouseup)="onMouseUp(i, 6, 'ID_de_la_tache','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][6], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][6]}">
                        {{element.ID_de_la_tache}} </td>
                    </ng-container>

                    <!-- Item___Nom Column -->
                    <ng-container matColumnDef="Item___Nom">
                      <th id="Item___NomException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Item___Nom
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[7].columnProp}}"
                            [(ngModel)]="optionsException[7].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[7],$event)">
                            <mat-option value="">-- Select {{optionsException[7].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[7].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 7, 'Item___Nom','exception')"
                        (mouseup)="onMouseUp(i, 7, 'Item___Nom','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][7], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][7]}">
                        {{element.Item___Nom}} </td>
                    </ng-container>

                    <!-- Item___Type Column -->
                    <ng-container matColumnDef="Item___Type">
                      <th id="Item___TypeException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Item___Type
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[8].columnProp}}"
                            [(ngModel)]="optionsException[8].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[8],$event)">
                            <mat-option value="">-- Select {{optionsException[8].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[8].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 8, 'Item___Type','exception')"
                        (mouseup)="onMouseUp(i, 8, 'Item___Type','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][8], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][8]}">
                        {{element.Item___Type}} </td>
                    </ng-container>

                    <!-- Item___Quantite Column -->
                    <ng-container matColumnDef="Item___Quantite">
                      <th id="Item___QuantiteException" class="titre-column-exception" mat-header-cell
                        *matHeaderCellDef>
                        Item___Quantite
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[9].columnProp}}"
                            [(ngModel)]="optionsException[9].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[9],$event)">
                            <mat-option value="">-- Select {{optionsException[9].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[9].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 9, 'Item___Quantite','exception')"
                        (mouseup)="onMouseUp(i, 9, 'Item___Quantite','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][9], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][9]}">
                        {{element.Item___Quantite}} </td>
                    </ng-container>

                    <!-- Code_postal Column -->
                    <ng-container matColumnDef="Code_postal">
                      <th id="Code_postalException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Code_postal
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[10].columnProp}}"
                            [(ngModel)]="optionsException[10].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[10],$event)">
                            <mat-option value="">-- Select {{optionsException[10].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[10].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 10, 'Code_postal','exception')"
                        (mouseup)="onMouseUp(i, 10, 'Code_postal','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][10], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][10]}">
                        {{element.Code_postal}} </td>
                    </ng-container>

                    <!-- Round_Name Column -->
                    <ng-container matColumnDef="Round_Name">
                      <th id="Round_NameException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Round_Name
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[11].columnProp}}"
                            [(ngModel)]="optionsException[11].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[11],$event)">
                            <mat-option value="">-- Select {{optionsException[11].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[11].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 11, 'Round_Name','exception')"
                        (mouseup)="onMouseUp(i, 11, 'Round_Name','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][11], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][11]}">
                        {{element.Round_Name}} </td>
                    </ng-container>

                    <!-- Remarque Column -->
                    <!-- (mousedown)="onMouseDown(i, 12, 'Remarque','exception')"
                  (mouseup)="onMouseUp(i, 12, 'Remarque','exception')"
                  [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][12], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][12]}" -->
                    <ng-container matColumnDef="Remarque">
                      <th id="RemarqueException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Remarque
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[12].columnProp}}"
                            [(ngModel)]="optionsException[12].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[12],$event)">
                            <mat-option value="">-- Select {{optionsException[12].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[12].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index">
                        {{element.Remarque}} </td>
                    </ng-container>


                    <!-- Remarque Column -->
                    <ng-container matColumnDef="Express">
                      <th id="ExpressException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        Express
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[13].columnProp}}"
                            [(ngModel)]="optionsException[13].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[13],$event)">
                            <mat-option value="">-- Select {{optionsException[13].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[13].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 13, 'Express','exception')"
                        (mouseup)="onMouseUp(i, 13, 'Express','exception')"
                        [ngClass]="{'selected': selectedCellsStateException[i+ paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][13], 'unselected': !selectedCellsStateException[i+paginator.toArray()[1].pageIndex*paginator.toArray()[1].pageSize][13]}">
                        {{element.Express}} </td>
                    </ng-container>

                    <ng-container matColumnDef="billingRoundName">
                      <th id="billingRoundNameException" class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        billingRoundName
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsException[14].columnProp}}"
                            [(ngModel)]="optionsException[14].modelValue"
                            (selectionChange)="setFilteredItemsExceptionOptions(optionsException[14],$event)">
                            <mat-option value="">-- Select {{optionsException[14].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsException[14].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>

                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index">
                        {{element.billingRoundName}} </td>
                    </ng-container>

                    <!-- isDeleted Column -->
                    <ng-container matColumnDef="isDeleted">
                      <th id="isDeletedException" style="padding-bottom: 16px !important;"
                        class="titre-column-exception" mat-header-cell *matHeaderCellDef>
                        isDeleted
                        <mat-checkbox style="margin-left:5px"
                          (change)="$event ? deleteMasterToggleException($event) : null"
                          [checked]=" allException==true ">
                        </mat-checkbox>
                      </th>
                      <td mat-cell #cellException class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index">
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()"
                          [checked]=" isRowExceptionSelected(element.taskId)"
                          (change)="selectDeleteRow(element,'exception')">
                        </mat-checkbox>
                      </td>

                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumnsException; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsException;"></tr>
                  </table>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </base-card-body>
        </base-card>


      </div>
      <div class="content-labels">

        <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
          <base-card-title class="reorder">
            <div>
              <label>Fichier Metadata </label>
            </div>
            <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
              <div class="mdl-textfield label-search">
                <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsMetadata()"
                  [(ngModel)]="filterValuemetadata" placeholder="Rechercher" autocomplete="off" />
                <label class="mdl-textfield__label" for="search2"></label>
              </div>
            </div>
          </base-card-title>
          <base-card-body class="content-file-line">
            <mat-accordion>
              <mat-expansion-panel hideToggle>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Afficher Log
                  </mat-panel-title>
                  <mat-panel-description class="description">
                    <!-- <button (click)='correctionFile("metadata");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button> -->
                    <button (click)='resetFiltre("metadata");$event.stopPropagation();' style="margin-left: 5px;"
                      class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                      les filtres
                    </button>
                  </mat-panel-description>
                </mat-expansion-panel-header>
                <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                  [show]="showLoaderMetadataFile"></app-loader>
                <div class="content-table">
                  <div>
                    <mat-paginator [hidden]="!dataSourceMetaData.data.length" [pageSizeOptions]="[100,200,300]"
                      showFirstLastButtons></mat-paginator>
                  </div>
                  <table mat-table [dataSource]="dataSourceMetaData" *ngIf="dataSourceMetaData.data.length > 0"
                    class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">

                    <!-- Date Column -->
                    <ng-container matColumnDef="Date">
                      <th id="DateMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef> Date
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[0].columnProp}}"
                            [(ngModel)]="optionsMetaData[0].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[0],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[0].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[0].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 0, 'Date','metadata')"
                        (mouseup)="onMouseUp(i, 0, 'Date','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][0], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][0]}">
                        {{element.Date}} </td>
                    </ng-container>

                    <!-- Expediteur Column -->
                    <ng-container matColumnDef="Expediteur">
                      <th id="ExpediteurMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        Expediteur
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[1].columnProp}}"
                            [(ngModel)]="optionsMetaData[1].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[1],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[1].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[1].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 1, 'Expediteur','metadata')"
                        (mouseup)="onMouseUp(i, 1, 'Expediteur','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][1], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][1]}">
                        {{element.Expediteur}} </td>
                    </ng-container>

                    <!-- Activite Column -->
                    <ng-container matColumnDef="Activite">
                      <th id="ActiviteMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        Activite
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[2].columnProp}}"
                            [(ngModel)]="optionsMetaData[2].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[2],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[2].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[2].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 2, 'Activite','metadata')"
                        (mouseup)="onMouseUp(i, 2, 'Activite','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][2], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][2]}">
                        {{element.Activite}} </td>
                    </ng-container>

                    <!-- Categorie Column -->
                    <ng-container matColumnDef="Categorie">
                      <th id="CategorieMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        Categorie
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[3].columnProp}}"
                            [(ngModel)]="optionsMetaData[3].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[3],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[3].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[3].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 3, 'Categorie','metadata')"
                        (mouseup)="onMouseUp(i, 3, 'Categorie','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][3], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][3]}">
                        {{element.Categorie}} </td>
                    </ng-container>

                    <!-- Type_de_Service Column -->
                    <ng-container matColumnDef="Type_de_Service">
                      <th id="Type_de_ServiceMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        Type_de_Service
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[4].columnProp}}"
                            [(ngModel)]="optionsMetaData[4].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[4],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[4].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[4].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 4, 'Type_de_Service','metadata')"
                        (mouseup)="onMouseUp(i, 4, 'Type_de_Service','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][4], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][4]}">
                        {{element.Type_de_Service}} </td>
                    </ng-container>

                    <!-- ID_de_la_tache Column -->
                    <ng-container matColumnDef="ID_de_la_tache">
                      <th id="ID_de_la_tacheMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        ID_de_la_tache
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[5].columnProp}}"
                            [(ngModel)]="optionsMetaData[5].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[5],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[5].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[5].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 5, 'ID_de_la_tache','metadata')"
                        (mouseup)="onMouseUp(i, 5, 'ID_de_la_tache','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][5], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][5]}">
                        {{element.ID_de_la_tache}} </td>
                    </ng-container>

                    <!-- Item___Nom_sous_categorie Column -->
                    <ng-container matColumnDef="Item___Nom_sous_categorie">
                      <th id="Item___Nom_sous_categorieMetaData" class="titre-column-metadata" mat-header-cell
                        *matHeaderCellDef> Item___Nom_sous_categorie
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[6].columnProp}}"
                            [(ngModel)]="optionsMetaData[6].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[6],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[6].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[6].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 6, 'Item___Nom_sous_categorie','metadata')"
                        (mouseup)="onMouseUp(i, 6, 'Item___Nom_sous_categorie','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][6], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][6]}">
                        {{element.Item___Nom_sous_categorie}} </td>
                    </ng-container>

                    <!-- Item___Type_unite_manutention Column -->
                    <ng-container matColumnDef="Item___Type_unite_manutention">
                      <th id="Item___Type_unite_manutentionMetaData" class="titre-column-metadata" mat-header-cell
                        *matHeaderCellDef> Item___Type_unite_manutention
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[7].columnProp}}"
                            [(ngModel)]="optionsMetaData[7].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[7],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[7].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[7].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 7, 'Item___Type_unite_manutention','metadata')"
                        (mouseup)="onMouseUp(i, 7, 'Item___Type_unite_manutention','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][7], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][7]}">
                        {{element.Item___Type_unite_manutention}} </td>
                    </ng-container>

                    <!-- Item___Quantite Column -->
                    <ng-container matColumnDef="Item___Quantite">
                      <th id="Item___QuantiteMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        Item___Quantite
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[8].columnProp}}"
                            [(ngModel)]="optionsMetaData[8].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[8],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[8].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[8].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 8, 'Item___Quantite','metadata')"
                        (mouseup)="onMouseUp(i, 8, 'Item___Quantite','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][8], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][8]}">
                        {{element.Item___Quantite}} </td>
                    </ng-container>

                    <!-- Code_postal Column -->
                    <ng-container matColumnDef="Code_postal">
                      <th id="Code_postalMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        Code_postal
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[9].columnProp}}"
                            [(ngModel)]="optionsMetaData[9].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[9],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[9].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[9].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 9, 'Code_postal','metadata')"
                        (mouseup)="onMouseUp(i, 9, 'Code_postal','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][9], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][9]}">
                        {{element.Code_postal}} </td>
                    </ng-container>

                    <!-- sourceHubName Column -->
                    <ng-container matColumnDef="sourceHubName">
                      <th id="sourceHubNameMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        sourceHubName
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[10].columnProp}}"
                            [(ngModel)]="optionsMetaData[10].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[10],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[10].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[10].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 10, 'sourceHubName','metadata')"
                        (mouseup)="onMouseUp(i, 10, 'sourceHubName','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][10], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][10]}">
                        {{element.sourceHubName}} </td>
                    </ng-container>

                    <!-- Round_Name Column -->
                    <ng-container matColumnDef="Round_Name">
                      <th id="Round_NameMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef>
                        Round_Name
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[11].columnProp}}"
                            [(ngModel)]="optionsMetaData[11].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[11],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[11].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[11].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 11, 'Round_Name','metadata')"
                        (mouseup)="onMouseUp(i, 11, 'Round_Name','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][11], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][11]}">
                        {{element.Round_Name}} </td>
                    </ng-container>

                    <!-- sourceClosureDate Column -->
                    <ng-container matColumnDef="sourceClosureDate">
                      <th id="sourceClosureDateMetaData" class="titre-column-metadata" mat-header-cell
                        *matHeaderCellDef>
                        sourceClosureDate
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[12].columnProp}}"
                            [(ngModel)]="optionsMetaData[12].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[12],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[12].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[12].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 12, 'sourceClosureDate','metadata')"
                        (mouseup)="onMouseUp(i, 12, 'sourceClosureDate','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][12], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][12]}">
                        {{element.sourceClosureDate}} </td>
                    </ng-container>

                    <!-- realInfoHasPrepared Column -->
                    <ng-container matColumnDef="realInfoHasPrepared">
                      <th id="realInfoHasPreparedMetaData" class="titre-column-metadata" mat-header-cell
                        *matHeaderCellDef> realInfoHasPrepared
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[13].columnProp}}"
                            [(ngModel)]="optionsMetaData[13].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[13],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[13].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[13].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 13, 'realInfoHasPrepared','metadata')"
                        (mouseup)="onMouseUp(i, 13, 'realInfoHasPrepared','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][13], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][13]}">
                        {{element.realInfoHasPrepared}} </td>
                    </ng-container>

                    <!-- status Column -->
                    <ng-container matColumnDef="status">
                      <th id="statusMetaData" class="titre-column-metadata" mat-header-cell *matHeaderCellDef> status
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[14].columnProp}}"
                            [(ngModel)]="optionsMetaData[14].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[14],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[14].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[14].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 14, 'status','metadata')"
                        (mouseup)="onMouseUp(i, 14, 'status','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][14], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][14]}">
                        {{element.status}} </td>
                    </ng-container>

                    <!-- metadataFACTURATION Column -->
                    <ng-container matColumnDef="metadataFACTURATION">
                      <th id="metadataFACTURATIONMetaData" class="titre-column-metadata" mat-header-cell
                        *matHeaderCellDef> metadataFACTURATION
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMetaData[15].columnProp}}"
                            [(ngModel)]="optionsMetaData[15].modelValue"
                            (selectionChange)="setFilteredItemsMetaDataOptions(optionsMetaData[15],$event)">
                            <mat-option value="">-- Select {{optionsMetaData[15].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMetaData[15].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMetadata class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 15, 'metadataFACTURATION','metadata')"
                        (mouseup)="onMouseUp(i, 15, 'metadataFACTURATION','metadata')"
                        [ngClass]="{'selected': selectedCellsStateMetaData[i+ paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][15], 'unselected': !selectedCellsStateMetaData[i+paginator.toArray()[2].pageIndex*paginator.toArray()[2].pageSize][15]}">
                        {{element.metadataFACTURATION}} </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumnsMetadata; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsMetadata;"></tr>
                  </table>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </base-card-body>
        </base-card>


      </div>
      <div class="content-labels">

        <base-card class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--6-col-phone">
          <base-card-title class="reorder">
            <div>
              <label>Fichier MAD </label>
            </div>
            <div class="mdl-textfield-search mdl-js-textfield mdl-textfield--expandable search-table">
              <div class="mdl-textfield label-search">
                <input class="mdl-textfield__input" type="text" id="search2" (input)="setFilteredItemsMAD()"
                  [(ngModel)]="filterValueMad" placeholder="Rechercher" autocomplete="off" />
                <label class="mdl-textfield__label" for="search2"></label>
              </div>
            </div>
          </base-card-title>
          <base-card-body class="content-file-line">
            <mat-accordion>
              <mat-expansion-panel hideToggle>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Afficher Log
                  </mat-panel-title>
                  <mat-panel-description class="description">
                    <!-- <button (click)='deleteRowsMad();$event.stopPropagation();' id="deleteWrongBtn"
                    [disabled]=" rowsToDeleteMad?.length==0 || alreadyClicked==true" style="margin-right: 5px;"
                    class=" delete-button mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal">Effacer
                  </button>
                  <button (click)='correctionFile("mad");$event.stopPropagation();'
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Corriger
                  </button> -->
                    <button (click)='resetFiltre("mad");$event.stopPropagation();' style="margin-left: 5px;"
                      class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button--colored-teal dialog-button">Réinitialiser
                      les filtres
                    </button>
                  </mat-panel-description>
                </mat-expansion-panel-header>
                <app-loader [width]="'94%'" [position]="'initial'" [height]="'0%'" [bg]="'transparant'"
                  [show]="showLoaderMadFile"></app-loader>
                <div class="content-table">
                  <div>
                    <mat-paginator [hidden]="!dataSourceMAD.data.length" [pageSizeOptions]="[100,200,300]"
                      showFirstLastButtons></mat-paginator>
                  </div>
                  <table mat-table [dataSource]="dataSourceMAD" *ngIf="dataSourceMAD.data.length > 0"
                    class="table-livraison mdl-data-table mdl-js-data-table  sorting-table">

                    <!-- Date Column -->
                    <ng-container matColumnDef="Date">
                      <th id="DateMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> Date
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[1].columnProp}}"
                            [(ngModel)]="optionsMad[1].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[1],$event)">
                            <mat-option value="">-- Select {{optionsMad[1].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[1].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 1, 'Date','mad')"
                        (mouseup)="onMouseUp(i, 1, 'Date','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][1], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][1]}">
                        {{element.Date}} </td>
                    </ng-container>

                    <!-- Expediteur Column -->
                    <ng-container matColumnDef="Expediteur">
                      <th id="ExpediteurMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> Expediteur
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[2].columnProp}}"
                            [(ngModel)]="optionsMad[2].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[2],$event)">
                            <mat-option value="">-- Select {{optionsMad[2].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[2].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 2, 'Expediteur','mad')"
                        (mouseup)="onMouseUp(i, 2, 'Expediteur','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][2], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][2]}">
                        {{element.Expediteur}} </td>
                    </ng-container>

                    <!-- Activite Column -->
                    <ng-container matColumnDef="Activite">
                      <th id="ActiviteMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> Activite
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[3].columnProp}}"
                            [(ngModel)]="optionsMad[3].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[3],$event)">
                            <mat-option value="">-- Select {{optionsMad[3].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[3].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 3, 'Activite','mad')"
                        (mouseup)="onMouseUp(i, 3, 'Activite','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][3], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][3]}">
                        {{element.Activite}} </td>
                    </ng-container>

                    <!-- Categorie Column -->
                    <ng-container matColumnDef="Categorie">
                      <th id="CategorieMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> Categorie
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[4].columnProp}}"
                            [(ngModel)]="optionsMad[4].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[4],$event)">
                            <mat-option value="">-- Select {{optionsMad[4].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[4].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 4, 'Categorie','mad')"
                        (mouseup)="onMouseUp(i, 4, 'Categorie','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][4], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][4]}">
                        {{element.Categorie}} </td>
                    </ng-container>

                    <!-- Type_de_Service Column -->
                    <ng-container matColumnDef="Type_de_Service">
                      <th id="Type_de_ServiceMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef>
                        Type_de_Service
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[5].columnProp}}"
                            [(ngModel)]="optionsMad[5].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[5],$event)">
                            <mat-option value="">-- Select {{optionsMad[5].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[5].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 5, 'Type_de_Service','mad')"
                        (mouseup)="onMouseUp(i, 5, 'Type_de_Service','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][5], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][5]}">
                        {{element.Type_de_Service}} </td>
                    </ng-container>

                    <!-- ID_de_la_tache Column -->
                    <ng-container matColumnDef="ID_de_la_tache">
                      <th id="ID_de_la_tacheMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef>
                        ID_de_la_tache
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[6].columnProp}}"
                            [(ngModel)]="optionsMad[6].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[6],$event)">
                            <mat-option value="">-- Select {{optionsMad[6].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[6].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 6, 'ID_de_la_tache','mad')"
                        (mouseup)="onMouseUp(i, 6, 'ID_de_la_tache','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][6], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][6]}">
                        {{element.ID_de_la_tache}} </td>
                    </ng-container>

                    <!-- Item___Nom_sous_categorie Column -->
                    <ng-container matColumnDef="Item___Nom_sous_categorie">
                      <th id="Item___Nom_sous_categorieMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef>
                        Item___Nom_sous_categorie
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[7].columnProp}}"
                            [(ngModel)]="optionsMad[7].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[7],$event)">
                            <mat-option value="">-- Select {{optionsMad[7].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[7].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 7, 'Item___Nom_sous_categorie','mad')"
                        (mouseup)="onMouseUp(i, 7, 'Item___Nom_sous_categorie','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][7], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][7]}">
                        {{element.Item___Nom_sous_categorie}} </td>
                    </ng-container>

                    <!-- Item___Type_unite_manutention Column -->
                    <ng-container matColumnDef="Item___Type_unite_manutention">
                      <th id="Item___Type_unite_manutentionMad" class="titre-column-mad" mat-header-cell
                        *matHeaderCellDef> Item___Type_unite_manutention
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[8].columnProp}}"
                            [(ngModel)]="optionsMad[8].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[8],$event)">
                            <mat-option value="">-- Select {{optionsMad[8].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[8].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 8, 'Item___Type_unite_manutention','mad')"
                        (mouseup)="onMouseUp(i, 8, 'Item___Type_unite_manutention','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][8], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][8]}">
                        {{element.Item___Type_unite_manutention}} </td>
                    </ng-container>

                    <!-- Item___Quantite Column -->
                    <ng-container matColumnDef="Item___Quantite">
                      <th id="Item___QuantiteMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef>
                        Item___Quantite
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[9].columnProp}}"
                            [(ngModel)]="optionsMad[9].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[9],$event)">
                            <mat-option value="">-- Select {{optionsMad[9].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[9].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 9, 'Item___Quantite','mad')"
                        (mouseup)="onMouseUp(i, 9, 'Item___Quantite','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][9], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][9]}">
                        {{element.Item___Quantite}} </td>
                    </ng-container>

                    <!-- Code_postal Column -->
                    <ng-container matColumnDef="Code_postal">
                      <th id="Code_postalMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> Code_postal
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[10].columnProp}}"
                            [(ngModel)]="optionsMad[10].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[10],$event)">
                            <mat-option value="">-- Select {{optionsMad[10].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[10].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 10, 'Code_postal','mad')"
                        (mouseup)="onMouseUp(i, 10, 'Code_postal','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][10], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][10]}">
                        {{element.Code_postal}} </td>
                    </ng-container>

                    <!-- sourceHubName Column -->
                    <ng-container matColumnDef="sourceHubName">
                      <th id="sourceHubNameMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef>
                        sourceHubName
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[11].columnProp}}"
                            [(ngModel)]="optionsMad[11].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[11],$event)">
                            <mat-option value="">-- Select {{optionsMad[11].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[11].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index"
                        (mousedown)="onMouseDown(i, 11, 'sourceHubName','mad')"
                        (mouseup)="onMouseUp(i, 11, 'sourceHubName','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][11], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][11]}">
                        {{element.sourceHubName}} </td>
                    </ng-container>

                    <!-- Round_Name Column -->
                    <ng-container matColumnDef="Round_Name">
                      <th id="Round_NameMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> Round_Name
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[12].columnProp}}"
                            [(ngModel)]="optionsMad[12].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[12],$event)">
                            <mat-option value="">-- Select {{optionsMad[12].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[12].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 12, 'Round_Name','mad')"
                        (mouseup)="onMouseUp(i, 12, 'Round_Name','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][12], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][12]}">
                        {{element.Round_Name}} </td>
                    </ng-container>


                    <!-- StartTime Column -->
                    <ng-container matColumnDef="StartTime">
                      <th id="StartTimeMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> StartTime
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[13].columnProp}}"
                            [(ngModel)]="optionsMad[13].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[13],$event)">
                            <mat-option value="">-- Select {{optionsMad[13].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[13].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 13, 'StartTime','mad')"
                        (mouseup)="onMouseUp(i, 13, 'StartTime','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][13], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][13]}">
                        {{element.StartTime | date:"yyyy/MM/dd 'à' HH:mm" }} </td>
                    </ng-container>


                    <!-- ClousureTime Column -->
                    <ng-container matColumnDef="ClousureTime">
                      <th id="ClousureTimeMad" class="titre-column-mad" mat-header-cell *matHeaderCellDef> ClousureTime
                        <mat-form-field class="form-column" appearance="fill">
                          <mat-select class="filter-column" matNativeControl name="{{optionsMad[14].columnProp}}"
                            [(ngModel)]="optionsMad[14].modelValue"
                            (selectionChange)="setFilteredItemsMadOptions(optionsMad[14],$event)">
                            <mat-option value="">-- Select {{optionsMad[14].columnProp}}--</mat-option>
                            <mat-option [value]="item" *ngFor="let item of optionsMad[14].options">
                              <label>{{item}}</label>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index" (mousedown)="onMouseDown(i, 14, 'ClousureTime','mad')"
                        (mouseup)="onMouseUp(i, 14, 'ClousureTime','mad')"
                        [ngClass]="{'selected': selectedCellsStateMad[i+ paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][14], 'unselected': !selectedCellsStateMad[i+paginator.toArray()[3].pageIndex*paginator.toArray()[3].pageSize][14]}">
                        {{element.ClousureTime| date:"yyyy/MM/dd 'à' HH:mm"}} </td>
                    </ng-container>



                    <ng-container matColumnDef="toDelete">
                      <th id="isDeletedMad" style="padding-bottom: 16px;" class="titre-column-Mad" mat-header-cell
                        *matHeaderCellDef>
                        toDelete
                      </th>
                      <td mat-cell #cellMad class="center-cell-transactionsFiles"
                        *matCellDef="let element ; let i = index">
                        <mat-checkbox color="warn" (click)="$event.stopPropagation()" [checked]="element.toDelete==1"
                          (change)="selectDeleteRow(element,'mad')">
                        </mat-checkbox>
                      </td>

                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumnsMad; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsMad;"></tr>
                  </table>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </base-card-body>
        </base-card>


      </div>
    </div>
  </div>
</div>